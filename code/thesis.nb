(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     49391,       1253]
NotebookOptionsPosition[     45788,       1180]
NotebookOutlinePosition[     46227,       1197]
CellTagsIndexPosition[     46184,       1194]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Functions and exports", "Subtitle",
 CellChangeTimes->{{3.85936652086769*^9, 
  3.859366525086912*^9}},ExpressionUUID->"fe6e5635-cccc-4c69-8483-\
4b9bf6e24a62"],

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<CoolTools`\>\"", "]"}], "\n", 
 RowBox[{"Needs", "[", "\"\<Carlos`\>\"", "]"}], "\n", 
 RowBox[{"Needs", "[", "\"\<Quantum`\>\"", "]"}], "\n", 
 RowBox[{"Needs", "[", "\"\<ThesisTools`\>\"", "]"}], "\n", 
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\</home/acastillo/Documents/tesis-adan/code\>\"", 
   "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[8]:=",ExpressionUUID->"948f4800-b534-400d-8f1c-6cf610442443"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PNGSetToGif", "[", 
     RowBox[{"set_", ",", "name_"}], "]"}], ":=", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"\"\<../figures/\>\"", "<>", "name", "<>", "\"\<.gif\>\""}], 
      ",", "\n", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"set", ",", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"set", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"Length", "[", "set", "]"}]}], "}"}]}], "]"}]}], "}"}], 
       "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"l", "[", 
    RowBox[{"r_", ",", "p_", ",", "lo_", ",", "up_", ",", "st_"}], "]"}], ":=", 
   RowBox[{"First", "@", 
    RowBox[{"LagrangeMultFromZCoord", "[", "\n", "\t", 
     RowBox[{
      RowBox[{"RzLambdaTable", "[", 
       RowBox[{"p", ",", "lo", ",", "up", ",", "st"}], "]"}], ",", "\n", "\t",
       "r"}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8593665542265778`*^9, 3.859366608122987*^9}, {
  3.8593666465037003`*^9, 3.859366648068783*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"1f776568-4246-4954-b862-2ef85c9572bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SWAP Dynamics", "Subtitle",
 CellChangeTimes->{{3.859366207216239*^9, 
  3.859366261398419*^9}},ExpressionUUID->"ec464118-70ea-429d-94b6-\
1a2c05670541"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"x1", "[", "t", "]"}], "/.", 
  RowBox[{"s", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.864406896039102*^9, 3.8644069245268717`*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"f1141475-410c-4f45-8d47-091d63c26001"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   RowBox[{
    TagBox["InterpolatingFunction",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{{{{}, {}, 
                 TagBox[{
                   Directive[
                    Opacity[1.], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1]], 
                   LineBox[CompressedData["
1:eJwB0QMu/CFib1JlAgAAADwAAAACAAAA0d0e+0GWXD43cv5b3M7bP8/aSIyo
OJo/GbKD0BPY2j+WOpaK+FKrPytjaoa+wtk/2+dwMj5MtD+CJiGwU7fYP1Yy
X3etzbo/ZiqfQO6p1z9QmuaWIu7AP/VpFHVtftY/cg2UVyY5xD8Wd55l3WDV
P3xcAVG+ysc/4ZSlGLMl1D9761L2rEvLP1rcDYhx69I/d+wagVOQzj8i+Ao7
0sLRP65kUSLHDdE/bENjmkp+0D8ejNB2QLXSPwkMEnbxms4/idNBIWVU1D/1
nhbNbUPMP+gIE+jTFtY/D9KA3Km4yT9Fd5+hHrvXP79PBV7cWsc/ltOLd7OC
2T9sRHKfoc3EP+JPaqPzQds/x0lCVLpRwj8sBQTCD+PcPwuVOZUqB8A/aqj9
/HWn3j/tE6s3uCe7P1NCWRXcJuA/tagsNquotj9rp2M6ogvhP29I/a3P4rE/
gRxnCj7s4T/tHMWj96CqPxYuyNPHveI/sqjeE/BToj+lNlmr9qDjP96rEO7X
NJM/s9tHfBN15D/YqSZ4INNrP76QL/gFReU/xkD8gGy+hr/DPEeCnSbmP6oS
PwOYzJq/R4W8BSP55j9GN4xz6kGkv8XEYZdN3ec/T6wqKClMq79BFADUTb3o
P4bRbns+5bC/PAD8CTyO6T8l02YZh7qzvzHjJ07PcOo/2f5e2UWUtr+lYrGL
UETrP4sgdVlHBrm/FvIzdKcT7D9Fn2hniDa7v4F45mqj9Ow/08nPtPZYvb9r
m/ZajcbtPz776mmyG7+/T7U2WRyq7j9/zA+IMWHAv7Nr1FCZfu8/1JOxpwsH
wb8KmbX5dSfwPy+6uV+ui8G/t/cY0nGY8D9H5fAskfnBv6QkK6fkAfE/lDiw
mfg/wr8OTVUDKnTxP2cbvHT7aMK/d/37NFrk8T/ZcX7IZm3Cvx98UWMBTfI/
wtHkKIhRwr9E9r4Ye77yPwfuYIF4EMK/qT7bymso8z/s85gcL7PBvw0PdFJH
kPM/NWpO3H45wb/u2iRh9QD0P3VeqiLwk8C/DnWEbBpq9D/RITpV2rS/v6sK
/P4R3PQ//DVOIzzgvb9HKPBm9Ev1P8gHbMQ20ru/IhSTy0209T/JkTGHK665
v3r7Tbd5JfY/BmEk+8ket78SsbefHI/2P+o1DPBwg7S/J2I5D5IB9z+bzqqJ
8HWxvzubN1Tycfc/Z55w05t7rL+OouSVydr3PxZD1VyqGKa/XqWpXnNM+D+d
xA20gI6dv252HSSUtvg/hKetyPFgjr+ZnB5N+yH5P0/GqGsngVC+aGPyEg==

                    "]]}, 
                  Annotation[#, "Charting`Private`Tag$43642#1"]& ]}}, {}}, {
              DisplayFunction -> Identity, Ticks -> {Automatic, Automatic}, 
               AxesOrigin -> {0, 0}, FrameTicks -> {{{}, {}}, {{}, {}}}, 
               GridLines -> {None, None}, DisplayFunction -> Identity, 
               PlotRangePadding -> {{
                  Scaled[0.1], 
                  Scaled[0.1]}, {
                  Scaled[0.1], 
                  Scaled[0.1]}}, PlotRangeClipping -> True, ImagePadding -> 
               All, DisplayFunction -> Identity, AspectRatio -> 1, 
               Axes -> {False, False}, AxesLabel -> {None, None}, 
               AxesOrigin -> {0, 0}, DisplayFunction :> Identity, 
               Frame -> {{True, True}, {True, True}}, 
               FrameLabel -> {{None, None}, {None, None}}, FrameStyle -> 
               Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, 
               GridLines -> {None, None}, GridLinesStyle -> Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "DefaultBoundaryStyle" -> Automatic, 
                 "DefaultGraphicsInteraction" -> {
                  "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                   "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                 "DefaultMeshStyle" -> AbsolutePointSize[6], 
                 "ScalingFunctions" -> None, 
                 "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
                    (Identity[#]& )[
                    Part[#, 1]], 
                    (Identity[#]& )[
                    Part[#, 2]]}& ), "CopiedValueFunction" -> ({
                    (Identity[#]& )[
                    Part[#, 1]], 
                    (Identity[#]& )[
                    Part[#, 2]]}& )}}, 
               PlotRange -> {{0., 
                1.5707963267948966`}, {-0.14396366872541824`, 
                0.43450077995092634`}}, PlotRangeClipping -> True, 
               PlotRangePadding -> {{
                  Scaled[0.1], 
                  Scaled[0.1]}, {
                  Scaled[0.1], 
                  Scaled[0.1]}}, Ticks -> {Automatic, Automatic}}], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Domain: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"0.`", ",", "1.5707963267948966`"}], "}"}], "}"}],
                    "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Output: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["\"scalar\"", "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{{{{}, {}, 
                 TagBox[{
                   Directive[
                    Opacity[1.], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1]], 
                   LineBox[CompressedData["
1:eJwB0QMu/CFib1JlAgAAADwAAAACAAAA0d0e+0GWXD43cv5b3M7bP8/aSIyo
OJo/GbKD0BPY2j+WOpaK+FKrPytjaoa+wtk/2+dwMj5MtD+CJiGwU7fYP1Yy
X3etzbo/ZiqfQO6p1z9QmuaWIu7AP/VpFHVtftY/cg2UVyY5xD8Wd55l3WDV
P3xcAVG+ysc/4ZSlGLMl1D9761L2rEvLP1rcDYhx69I/d+wagVOQzj8i+Ao7
0sLRP65kUSLHDdE/bENjmkp+0D8ejNB2QLXSPwkMEnbxms4/idNBIWVU1D/1
nhbNbUPMP+gIE+jTFtY/D9KA3Km4yT9Fd5+hHrvXP79PBV7cWsc/ltOLd7OC
2T9sRHKfoc3EP+JPaqPzQds/x0lCVLpRwj8sBQTCD+PcPwuVOZUqB8A/aqj9
/HWn3j/tE6s3uCe7P1NCWRXcJuA/tagsNquotj9rp2M6ogvhP29I/a3P4rE/
gRxnCj7s4T/tHMWj96CqPxYuyNPHveI/sqjeE/BToj+lNlmr9qDjP96rEO7X
NJM/s9tHfBN15D/YqSZ4INNrP76QL/gFReU/xkD8gGy+hr/DPEeCnSbmP6oS
PwOYzJq/R4W8BSP55j9GN4xz6kGkv8XEYZdN3ec/T6wqKClMq79BFADUTb3o
P4bRbns+5bC/PAD8CTyO6T8l02YZh7qzvzHjJ07PcOo/2f5e2UWUtr+lYrGL
UETrP4sgdVlHBrm/FvIzdKcT7D9Fn2hniDa7v4F45mqj9Ow/08nPtPZYvb9r
m/ZajcbtPz776mmyG7+/T7U2WRyq7j9/zA+IMWHAv7Nr1FCZfu8/1JOxpwsH
wb8KmbX5dSfwPy+6uV+ui8G/t/cY0nGY8D9H5fAskfnBv6QkK6fkAfE/lDiw
mfg/wr8OTVUDKnTxP2cbvHT7aMK/d/37NFrk8T/ZcX7IZm3Cvx98UWMBTfI/
wtHkKIhRwr9E9r4Ye77yPwfuYIF4EMK/qT7bymso8z/s85gcL7PBvw0PdFJH
kPM/NWpO3H45wb/u2iRh9QD0P3VeqiLwk8C/DnWEbBpq9D/RITpV2rS/v6sK
/P4R3PQ//DVOIzzgvb9HKPBm9Ev1P8gHbMQ20ru/IhSTy0209T/JkTGHK665
v3r7Tbd5JfY/BmEk+8ket78SsbefHI/2P+o1DPBwg7S/J2I5D5IB9z+bzqqJ
8HWxvzubN1Tycfc/Z55w05t7rL+OouSVydr3PxZD1VyqGKa/XqWpXnNM+D+d
xA20gI6dv252HSSUtvg/hKetyPFgjr+ZnB5N+yH5P0/GqGsngVC+aGPyEg==

                    "]]}, 
                  Annotation[#, "Charting`Private`Tag$43642#1"]& ]}}, {}}, {
              DisplayFunction -> Identity, Ticks -> {Automatic, Automatic}, 
               AxesOrigin -> {0, 0}, FrameTicks -> {{{}, {}}, {{}, {}}}, 
               GridLines -> {None, None}, DisplayFunction -> Identity, 
               PlotRangePadding -> {{
                  Scaled[0.1], 
                  Scaled[0.1]}, {
                  Scaled[0.1], 
                  Scaled[0.1]}}, PlotRangeClipping -> True, ImagePadding -> 
               All, DisplayFunction -> Identity, AspectRatio -> 1, 
               Axes -> {False, False}, AxesLabel -> {None, None}, 
               AxesOrigin -> {0, 0}, DisplayFunction :> Identity, 
               Frame -> {{True, True}, {True, True}}, 
               FrameLabel -> {{None, None}, {None, None}}, FrameStyle -> 
               Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, 
               GridLines -> {None, None}, GridLinesStyle -> Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "DefaultBoundaryStyle" -> Automatic, 
                 "DefaultGraphicsInteraction" -> {
                  "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                   "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                 "DefaultMeshStyle" -> AbsolutePointSize[6], 
                 "ScalingFunctions" -> None, 
                 "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
                    (Identity[#]& )[
                    Part[#, 1]], 
                    (Identity[#]& )[
                    Part[#, 2]]}& ), "CopiedValueFunction" -> ({
                    (Identity[#]& )[
                    Part[#, 1]], 
                    (Identity[#]& )[
                    Part[#, 2]]}& )}}, 
               PlotRange -> {{0., 
                1.5707963267948966`}, {-0.14396366872541824`, 
                0.43450077995092634`}}, PlotRangeClipping -> True, 
               PlotRangePadding -> {{
                  Scaled[0.1], 
                  Scaled[0.1]}, {
                  Scaled[0.1], 
                  Scaled[0.1]}}, Ticks -> {Automatic, Automatic}}], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Domain: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"0.`", ",", "1.5707963267948966`"}], "}"}], "}"}],
                    "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Output: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["\"scalar\"", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Order: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["3", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Method: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["\"Hermite\"", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Periodic: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["False", "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   InterpolatingFunction[{{0., 1.5707963267948966`}}, {
    5, 7, 1, {95}, {4}, 0, 0, 0, 0, Automatic, {}, {}, False}, CompressedData["
1:eJxFxX0slAEcwPFz3lLychOGcLkjITbJyzk/IjWR97e1MDdlt0RRtGYsZctu
CbuTsW6uvHVsOkxt5+YlLZJbLDF14rzlZhynex5Ez8sffbfvPvTM3LgsKoVC
0cFOp/xvg0mTqeKdgNQbkuUbvcGvbwPSbrKvk1sMp97TxtXDT0D0VlOwEsuH
LoNf1Kl+ISx0ZF1esGoCbsq1ytToNyBLemXCSJdAuE5dYr2gF+TiZw20cSm4
uw2qP1AHII/C5pe+HIIWacDIJGcEFEV+f51d5VBhU2/NLpyAZqROspz6DQan
XkQ+D5yGn921y/4OsyBkM+9w6XPgxZkp/lI1D1UujkNL1UrYUt04clCzBPGd
HVGW/BXoLtBUnxX8hhP+rOnwWhUAR8cU2VqHno9KUYLLJozOhgd5JKphbrNt
Rr9sCzT6x+8pOrfByDbPrFehAXuvSXGl8R/wvnj+UnaAFko+PZw76NLC5ysD
hXwPBKzkBmbuLQi8s1TwFMMIpKb1GFUtIrDbxCsP1UXBJ+tRvvooCnmMogwh
DYV2ZU5UlA0K35cN5X52KOiuNcYw7FHwXGdNmDqioOX1SSow+92hRp+OwtOx
/vxSzDXRvJsQM+IBdbEPUxzt1PAD87DcLWIRM0HmjagwW3dYzduYj3VlVTuY
GebBxVrMQIfBbBSzSyRS4p5xLkvbxVy+uV2P29jGmcEtGbVFcK+rJi33MMf2
PJ1xWcY8H9y7FgFs3Da71TDceYYgEnf/dE4Mrt5aZizuMXFKHK75ravxuPzI
EcIevVXCKalBAq62gElo+PUcoVlJIGE1N4jQIimYUBBygfC+lDTZN5TQV0La
ukGqd0iaYRJGKD1JWkMn5TJJQ1xJrT1I/wHXGHom
    "], {
    Developer`PackedArrayForm, {0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24,
      26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 
     62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 
     98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126,
      128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150, 152, 154, 
     156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, 180, 182, 
     184, 186, 188, 190}, CompressedData["
1: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
     "]}, {
    Automatic}],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], "[", "t", "]"}]], "Output",
 CellChangeTimes->{{3.8644069090437393`*^9, 3.8644069247485247`*^9}},
 CellLabel->
  "Out[200]=",ExpressionUUID->"4729bb54-5d53-4272-9916-6f662b312b83"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"unit", "=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "I"}], "*", 
     RowBox[{"PauliMatrix", "[", "3", "]"}], "*", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rho0", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
      RowBox[{"vec", ".", 
       RowBox[{"Rest", "[", 
        RowBox[{"gellMannBasis", "[", "1", "]"}], "]"}]}]}], ")"}], "/", 
    "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"rho0", "+", 
      RowBox[{"unit", ".", "rho0", ".", 
       RowBox[{"Dagger", "[", "unit", "]"}]}]}], ")"}], "/", "2"}], "//", 
   "FullSimplify"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.864399195719101*^9, 3.86439933635953*^9}, {
  3.864399391679967*^9, 3.864399405022255*^9}, {3.864399566561883*^9, 
  3.86439957762221*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"6817f358-e77e-4c90-b4a9-48424081874a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"t", "-", 
             RowBox[{"Re", "[", "t", "]"}]}], ")"}]}]]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "z"}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"Re", "[", "t", "]"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{"x", "-", 
         RowBox[{"\[ImaginaryI]", " ", "y"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"Re", "[", "t", "]"}], "]"}]}]},
     {
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", 
           RowBox[{"Re", "[", "t", "]"}]}]]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"x", "+", 
         RowBox[{"\[ImaginaryI]", " ", "y"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"Conjugate", "[", "t", "]"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "t"}]], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Conjugate", "[", "t", "]"}]}]]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "z"}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8643993084245577`*^9, 3.86439932826412*^9}, {
   3.864399392929357*^9, 3.864399405965003*^9}, 3.8643995789620447`*^9},
 CellLabel->
  "Out[31]//MatrixForm=",ExpressionUUID->"16d3e883-eea3-4f71-acf0-\
3706f97ddc83"]
}, Open  ]],

Cell[CellGroupData[{

Cell["MaxEnt Construction", "Section",
 CellChangeTimes->{{3.8593662651745872`*^9, 
  3.8593662839909363`*^9}},ExpressionUUID->"363b329d-e74a-41ad-bb63-\
b3c094b1a5a5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "There", " ", "are", " ", "two", " ", "basic", " ", "parameters", " ", 
    "for", " ", "the", " ", "coarse", " ", "graining", " ", 
    RowBox[{"problem", ".", "\n", "The"}], " ", "norm", " ", "of", " ", "the",
     " ", "Bloch", " ", "vector", " ", "and", " ", "the", " ", "swap", " ", 
    "probability"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"r", "=", " ", "0.8"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"sp", "=", " ", "0.6"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ztargetstate", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
        RowBox[{"r", "*", 
         RowBox[{"PauliMatrix", "[", "3", "]"}]}]}], ")"}], "/", "2"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "then", " ", "have", " ", "to", " ", "construct", " ", "the", 
      " ", "maximum", " ", "entropy", " ", 
      RowBox[{"state", ".", " ", "Since"}], " ", "we", "\n", "have", " ", 
      "acces", " ", "to", " ", "the", " ", "rz", " ", "coordinate"}], ",", 
     " ", 
     RowBox[{
     "we", " ", "obtain", " ", "the", " ", "lagrange", " ", "mult", " ", "by",
       "\n", "numerically", " ", "approximating", " ", "the", " ", "inverse", 
      " ", "value"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"lstep", "=", "0.002"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"llow", "=", "0."}], ";"}], "\n", 
   RowBox[{
    RowBox[{"lup", "=", "6."}], ";"}], "\n", 
   RowBox[{
    RowBox[{"lagmult", "=", 
     RowBox[{"l", "[", 
      RowBox[{"r", ",", "sp", ",", "llow", ",", "lup", ",", "lstep"}], 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"ZMaxEnt", "=", 
     RowBox[{"CGMaxEntStateLM", "[", 
      RowBox[{"lagmult", ",", "sp"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<The maximum entropy state is: \>\"", ",", " ", 
     RowBox[{"ZMaxEnt", "//", "MatrixForm"}]}], "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<Fidelity between the coarse maximum entropy state and the target \
state: \>\"", ",", " ", 
     RowBox[{"fidelity", "[", 
      RowBox[{
       RowBox[{"CGKraus", "[", 
        RowBox[{"ZMaxEnt", ",", "sp"}], "]"}], ",", "ztargetstate"}], "]"}]}],
     "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.8593663046585484`*^9, {3.859366763697137*^9, 3.859366926961841*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"304616da-1258-4039-a9e5-4d209587c523"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"The maximum entropy state is: \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.7938508916318353`", "0.`", "0.`", "0.`"},
       {"0.`", "0.13833740290179797`", "0.`", "0.`"},
       {"0.`", "0.`", "0.057748400364201626`", "0.`"},
       {"0.`", "0.`", "0.`", "0.010063305102165018`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["The maximum entropy state is: ", 
   MatrixForm[{{0.7938508916318353, 0., 0., 0.}, {0., 0.13833740290179797`, 
    0., 0.}, {0., 0., 0.057748400364201626`, 0.}, {0., 0., 0., 
    0.010063305102165018`}}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.859366897738611*^9, 3.859366929909096*^9}},
 CellLabel->
  "During evaluation of \
In[30]:=",ExpressionUUID->"94d8da43-7a01-4a11-b2e7-09e624332db7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fidelity between the coarse maximum entropy state and the \
target state: \"\>", "\[InvisibleSpace]", "0.9999999937849087`"}],
  SequenceForm[
  "Fidelity between the coarse maximum entropy state and the target state: ", 
   0.9999999937849087],
  Editable->False]], "Print",
 CellChangeTimes->{{3.859366897738611*^9, 3.8593669299628363`*^9}},
 CellLabel->
  "During evaluation of \
In[30]:=",ExpressionUUID->"c222c776-f4f3-46e0-acbe-7b602c7edf04"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.863719852259251*^9, 
  3.8637198571436787`*^9}},ExpressionUUID->"13c5f043-c9b1-40da-8166-\
6d5d2f085f0c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerical", "Section",
 CellChangeTimes->{{3.859366955397182*^9, 3.859366956590522*^9}, {
  3.859367038720489*^9, 
  3.859367039855755*^9}},ExpressionUUID->"694143bf-a7c4-467c-9782-\
7de07a977dbb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "unitary", "]"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "We", " ", "create", " ", "mixed", " ", "states", " ", "with", " ", "a", 
     " ", "radius", " ", "of", " ", "zcoord"}], ",", " ", 
    RowBox[{
    "then", " ", "we", "\n", "obtain", " ", "their", " ", "corresponding", 
     " ", "MaxEnt", " ", "states"}]}], "*)"}], "\n"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"MaxEntsNotInZ", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"MaxEntForStateNotInZ", "[", 
       RowBox[{"#", ",", "ZMaxEnt"}], "]"}], "&"}], "/@", 
     RowBox[{"UniformMixedStates", "[", 
      RowBox[{"r", ",", "1500"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"unitary", "[", "t_", "]"}], ":=", 
   RowBox[{"SWAP", "[", "t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"NewMaxEnt", "=", 
   RowBox[{"unitary", " ", ".", " ", "ZMaxEnt", " ", ".", " ", 
    RowBox[{"Dagger", "[", 
     RowBox[{"unitary", "[", "1", "]"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"NewMaxEntsNotInZ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"unitary", "[", "1", "]"}], " ", ".", " ", "#", " ", ".", " ", 
      RowBox[{"Dagger", "[", 
       RowBox[{"unitary", "[", "1", "]"}], "]"}]}], "&"}], "/@", 
    "MaxEntsNotInZ"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"CoarseMaxEntsNotInZ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Chop", "[", 
      RowBox[{"CGKraus", "[", 
       RowBox[{"#", ",", "sp"}], "]"}], "]"}], "&"}], "/@", 
    "MaxEntsNotInZ"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CoarseNewMaxEntsNotInZ", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{"CGKraus", "[", 
        RowBox[{"#", ",", "sp"}], "]"}], "]"}], "&"}], "/@", 
     "NewMaxEntsNotInZ"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"PlotTwoCoarseSets", "[", 
   RowBox[{"CoarseMaxEntsNotInZ", ",", "CoarseNewMaxEntsNotInZ", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<Initial states\>\"", ",", "\"\<Final states\>\""}], "}"}], 
    ",", "\"\<Evolution of the Assignement Map\>\""}], "]"}], ";"}]}], "Input",\

 CellChangeTimes->{{3.859367110311902*^9, 
  3.859367175498414*^9}},ExpressionUUID->"56c2b746-0028-4f22-83c4-\
0d8e7460b090"]
}, Open  ]],

Cell["Analytical", "Section",
 CellChangeTimes->{{3.859367048038597*^9, 
  3.8593670601166697`*^9}},ExpressionUUID->"76c2670b-02be-419d-97b9-\
d19c67c33ecd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CNOT Dynamics", "Subtitle",
 CellChangeTimes->{{3.859366381105575*^9, 
  3.859366386346353*^9}},ExpressionUUID->"4d288cc2-50f0-4f0d-8eae-\
55e3c44db100"],

Cell["Separable Dynamics", "Subtitle",
 CellChangeTimes->{{3.8593663890803957`*^9, 
  3.859366398654264*^9}},ExpressionUUID->"9ff1690a-20cc-4701-b49e-\
3627021766ef"],

Cell[CellGroupData[{

Cell["Step by stem evolution", "Section",
 CellChangeTimes->{{3.8637113119995127`*^9, 
  3.863711319967884*^9}},ExpressionUUID->"affd7ee4-56c0-4345-acbf-\
420fae44357e"],

Cell[CellGroupData[{

Cell["SWAP example", "Subsubsection",
 CellChangeTimes->{{3.863711337570109*^9, 
  3.863711368683375*^9}},ExpressionUUID->"708565d5-125d-4045-9d7d-\
8a7a782055f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ti", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", " ", "0.8"}], ";"}], "\n", 
 RowBox[{"zstate", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
     RowBox[{"r", "*", 
      RowBox[{"PauliMatrix", "[", "3", "]"}]}]}], ")"}], "/", 
   "2"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sp", "=", " ", "0.6"}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "We", " ", "then", " ", "have", " ", "to", " ", "construct", " ", "the", 
     " ", "maximum", " ", "entropy", " ", 
     RowBox[{"state", ".", " ", "Since"}], " ", "we", "\n", "have", " ", 
     "acces", " ", "to", " ", "the", " ", "rz", " ", "coordinate"}], ",", " ", 
    RowBox[{
    "we", " ", "obtain", " ", "the", " ", "lagrange", " ", "mult", " ", "by", 
     "\n", "numerically", " ", "approximating", " ", "the", " ", "inverse", 
     " ", "value"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"lstep", "=", "0.002"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"llow", "=", "0."}], ";"}], "\n", 
 RowBox[{
  RowBox[{"lup", "=", "6."}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"lagmult", "=", 
    RowBox[{"l", "[", 
     RowBox[{"r", ",", "sp", ",", "llow", ",", "lup", ",", "lstep"}], "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ZMaxEnt", "=", 
   RowBox[{"CGMaxEntStateLM", "[", 
    RowBox[{"lagmult", ",", "sp"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxEntsNotInZ", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"MaxEntForStateNotInZ", "[", 
       RowBox[{"#", ",", "ZMaxEnt"}], "]"}], "&"}], "/@", 
     RowBox[{"UniformMixedStates", "[", 
      RowBox[{"r", ",", "1500"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"unitary", "[", "t_", "]"}], ":=", 
   RowBox[{"SWAP", "[", "t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"NewMaxEnt", "=", 
   RowBox[{"unitary", " ", ".", " ", "ZMaxEnt", " ", ".", " ", 
    RowBox[{"Dagger", "[", 
     RowBox[{"unitary", "[", "1", "]"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"NewMaxEntsNotInZ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"unitary", "[", "1", "]"}], " ", ".", " ", "#", " ", ".", " ", 
      RowBox[{"Dagger", "[", 
       RowBox[{"unitary", "[", "1", "]"}], "]"}]}], "&"}], "/@", 
    "MaxEntsNotInZ"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"CoarseMaxEntsNotInZ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Chop", "[", 
      RowBox[{"CGKraus", "[", 
       RowBox[{"#", ",", "sp"}], "]"}], "]"}], "&"}], "/@", 
    "MaxEntsNotInZ"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CoarseNewMaxEntsNotInZ", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{"CGKraus", "[", 
        RowBox[{"#", ",", "sp"}], "]"}], "]"}], "&"}], "/@", 
     "NewMaxEntsNotInZ"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxEntState", "=", 
    RowBox[{"CGMaxEntStateLM", "[", 
     RowBox[{"lagmult", ",", "sp"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"step", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"tf", "-", "ti"}], ")"}], "/", "n"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "We", " ", "create", " ", "mixed", " ", "states", " ", "with", " ", "a", 
     " ", "radius", " ", "of", " ", "r"}], ",", " ", 
    RowBox[{
    "then", " ", "we", "\n", "obtain", " ", "their", " ", "corresponding", 
     " ", "MaxEnt", " ", "states"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OriginalStates", "=", 
   RowBox[{"UniformMixedStates", "[", 
    RowBox[{"r", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxEnts", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"MaxEntAss", "[", 
       RowBox[{"#", ",", "sp"}], "]"}], "&"}], "/@", "OriginalStates"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"unitary", "[", "t_", "]"}], ":=", 
    RowBox[{"SWAP", "[", "t", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"MaxEntsT", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"unitary", "[", "step", "]"}], " ", ".", " ", "#", " ", ".",
           " ", 
          RowBox[{"Dagger", "[", 
           RowBox[{"unitary", "[", "step", "]"}], "]"}]}], "&"}], "/@", 
        "MaxEnts"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CoarseStates", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{"CGKraus", "[", 
           RowBox[{"#", ",", "sp"}], "]"}], "]"}], "&"}], "/@", 
        "MaxEntsT"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"MaxEnts", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"MaxEntAss", "[", 
          RowBox[{"#", ",", "sp"}], "]"}], "&"}], "/@", "CoarseStates"}]}], 
      ";"}], "\n", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"PlotTwoCoarseSets", "[", 
   RowBox[{"OriginalStates", ",", "CoarseStates", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<Initial states\>\"", ",", "\"\<Final states\>\""}], "}"}], 
    ",", "\"\<Evolution of the Assignement Map\>\""}], "]"}], ";"}]}], "Input",\

 CellChangeTimes->{{3.8637113724581823`*^9, 3.863711508681984*^9}, {
   3.863712049817457*^9, 3.863712157281748*^9}, {3.863712455779093*^9, 
   3.863712484739236*^9}, {3.863712635391427*^9, 3.863712644655285*^9}, {
   3.86371270617028*^9, 3.8637127323651457`*^9}, 3.863719883710424*^9, 
   3.863719928550292*^9, {3.863720042546507*^9, 3.863720066429805*^9}, {
   3.863720148937307*^9, 3.8637202544643297`*^9}, {3.8637204190840263`*^9, 
   3.863720492676187*^9}, {3.8637205548163347`*^9, 3.8637207475939198`*^9}, {
   3.863721071567078*^9, 3.863721079106204*^9}, {3.863721290977366*^9, 
   3.863721303044395*^9}, {3.8637213689354057`*^9, 3.863721369864326*^9}, {
   3.863721421346306*^9, 3.863721421489502*^9}, {3.863722235693859*^9, 
   3.863722236161216*^9}, {3.863722365276402*^9, 3.863722369780809*^9}, {
   3.8637224862303133`*^9, 
   3.863722560462739*^9}},ExpressionUUID->"e06d33ab-d4ed-4f89-9a06-\
12d436ad34a6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"OriginalStates", "=", 
  RowBox[{"UniformMixedStates", "[", 
   RowBox[{"r", ",", "2"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"MaxEnts", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"MaxEntAss", "[", 
     RowBox[{"#", ",", "sp"}], "]"}], "&"}], "/@", 
   "OriginalStates"}]}]}], "Input",
 CellChangeTimes->{{3.863722394537037*^9, 
  3.863722394671715*^9}},ExpressionUUID->"d7992e24-a1b4-4a7d-9c2e-\
946da6fa1171"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.631426760860912`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.34587684114572126`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.15197439681955044`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.34587684114572126`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.15197439681955044`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.368573239139088`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.8112144751189305`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.021636514285624176`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.25035457200941363`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.021636514285624176`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.25035457200941363`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.18878552488106953`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.863721412891149*^9, 3.863722376615803*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"c4b34be5-6ab7-4af3-bf7b-57727b35a153"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MaxEntForStateNotInZ", "[", 
    RowBox[{"#", ",", "ZMaxEnt"}], "]"}], "&"}], "/@", 
  RowBox[{"UniformMixedStates", "[", 
   RowBox[{"r", ",", "1500"}], "]"}]}]], "Input",ExpressionUUID->"1653ec4c-\
57ce-41e0-adc5-0a1a0477bbd1"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.86372241403758*^9, 
  3.863722421317462*^9}},ExpressionUUID->"a20753ff-356d-4b99-879a-\
681b7bdf8200"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.863716848695259*^9, 3.863716856154743*^9}},
 CellLabel->"",ExpressionUUID->"8ddfbf47-b850-4774-87e1-a77ba17c0c8d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["My first differential equation", "Section",
 CellChangeTimes->{{3.864410094263392*^9, 
  3.8644101082914953`*^9}},ExpressionUUID->"e6543f7b-5b18-4af8-987b-\
12093bbca74d"],

Cell[CellGroupData[{

Cell["Some preliminaries, a simple example", "Subsection",
 CellChangeTimes->{{3.864410111903483*^9, 
  3.864410127939443*^9}},ExpressionUUID->"1c58b345-9c88-4fd6-8ca2-\
1454b3fb7115"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Mt", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "3", "]"}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"2", "*", "t"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", "*", "t"}], "]"}]}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"2", "*", "t"}], "]"}], ",", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", "*", "t"}], "]"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ")"}], "/", 
    "2"}]}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{"La", " ", "evolucion", " ", "no", " ", "diferencial"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"incon", "=", 
   RowBox[{
    RowBox[{"RandomReal", "[", "]"}], "*", 
    RowBox[{"Normalize", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RandomReal", "[", "]"}], ",", "3"}], "]"}], "]"}]}]}], ";", 
  " ", 
  RowBox[{"(*", 
   RowBox[{"Condicion", " ", "incial", " ", "aleatoria"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"s", "=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x1", "'"}], "[", "t", "]"}], ",", 
          RowBox[{
           RowBox[{"x2", "'"}], "[", "t", "]"}], ",", 
          RowBox[{
           RowBox[{"x3", "'"}], "[", "t", "]"}]}], "}"}], "==", 
        RowBox[{
         RowBox[{"H3", "[", "t", "]"}], ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x1", "[", "t", "]"}], ",", 
           RowBox[{"x2", "[", "t", "]"}], ",", 
           RowBox[{"x3", "[", "t", "]"}]}], "}"}]}]}], ",", 
       RowBox[{
        RowBox[{"x1", "[", "0", "]"}], "==", 
        RowBox[{"incon", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"x2", "[", "0", "]"}], "==", 
        RowBox[{"incon", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"x3", "[", "0", "]"}], "==", 
        RowBox[{"incon", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "[", "t", "]"}], ",", 
       RowBox[{"x2", "[", "t", "]"}], ",", 
       RowBox[{"x3", "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", 
       RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "]"}]}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{"evolucion", " ", "diferencial"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Mt", "[", "t", "]"}], ".", "incon"}], "-", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", "[", "t", "]"}], ",", 
         RowBox[{"x2", "[", "t", "]"}], ",", 
         RowBox[{"x3", "[", "t", "]"}]}], "}"}]}], "/.", "s"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", 
      RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"M", "[", "t", "]"}], ".", "incon"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x1", "[", "t", "]"}], ",", 
        RowBox[{"x2", "[", "t", "]"}], ",", 
        RowBox[{"x3", "[", "t", "]"}]}], "}"}], "/.", "s"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", 
     RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<M\>\"", ",", "\"\<Dif\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.8", ",", "0.7"}], "}"}]}], "]"}]}]}], "]"}]}], "Input",Expre\
ssionUUID->"31f9484b-0cfd-48a5-a14e-b9e6d6826241"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 762},
WindowMargins->{{0, Automatic}, {0, Automatic}},
TaggingRules->Association["TryRealOnly" -> False],
FrontEndVersion->"12.3 for Linux x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c1e67f5a-d03a-47dc-954d-84c384851e49"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 166, 3, 53, "Subtitle",ExpressionUUID->"fe6e5635-cccc-4c69-8483-4b9bf6e24a62"],
Cell[749, 27, 478, 10, 129, "Input",ExpressionUUID->"948f4800-b534-400d-8f1c-6cf610442443",
 InitializationCell->True],
Cell[1230, 39, 1317, 35, 149, "Input",ExpressionUUID->"1f776568-4246-4954-b862-2ef85c9572bd",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[2584, 79, 159, 3, 53, "Subtitle",ExpressionUUID->"ec464118-70ea-429d-94b6-1a2c05670541"],
Cell[CellGroupData[{
Cell[2768, 86, 282, 7, 29, "Input",ExpressionUUID->"f1141475-410c-4f45-8d47-091d63c26001"],
Cell[3053, 95, 17250, 335, 65, "Output",ExpressionUUID->"4729bb54-5d53-4272-9916-6f662b312b83"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20340, 435, 1150, 34, 94, "Input",ExpressionUUID->"6817f358-e77e-4c90-b4a9-48424081874a"],
Cell[21493, 471, 2477, 70, 78, "Output",ExpressionUUID->"16d3e883-eea3-4f71-acf0-3706f97ddc83"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24007, 546, 168, 3, 68, "Section",ExpressionUUID->"363b329d-e74a-41ad-bb63-b3c094b1a5a5"],
Cell[CellGroupData[{
Cell[24200, 553, 2482, 64, 382, "Input",ExpressionUUID->"304616da-1258-4039-a9e5-4d209587c523"],
Cell[CellGroupData[{
Cell[26707, 621, 1199, 28, 72, "Print",ExpressionUUID->"94d8da43-7a01-4a11-b2e7-09e624332db7"],
Cell[27909, 651, 497, 11, 23, "Print",ExpressionUUID->"c222c776-f4f3-46e0-acbe-7b602c7edf04"]
}, Open  ]]
}, Open  ]],
Cell[28433, 666, 154, 3, 29, "Input",ExpressionUUID->"13c5f043-c9b1-40da-8166-6d5d2f085f0c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28624, 674, 203, 4, 68, "Section",ExpressionUUID->"694143bf-a7c4-467c-9782-7de07a977dbb"],
Cell[28830, 680, 2290, 66, 298, "Input",ExpressionUUID->"56c2b746-0028-4f22-83c4-0d8e7460b090"]
}, Open  ]],
Cell[31135, 749, 157, 3, 68, "Section",ExpressionUUID->"76c2670b-02be-419d-97b9-d19c67c33ecd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31329, 757, 159, 3, 53, "Subtitle",ExpressionUUID->"4d288cc2-50f0-4f0d-8eae-55e3c44db100"],
Cell[31491, 762, 166, 3, 53, "Subtitle",ExpressionUUID->"9ff1690a-20cc-4701-b49e-3627021766ef"],
Cell[CellGroupData[{
Cell[31682, 769, 169, 3, 68, "Section",ExpressionUUID->"affd7ee4-56c0-4345-acbf-420fae44357e"],
Cell[CellGroupData[{
Cell[31876, 776, 163, 3, 45, "Subsubsection",ExpressionUUID->"708565d5-125d-4045-9d7d-8a7a782055f8"],
Cell[32042, 781, 6595, 182, 858, "Input",ExpressionUUID->"e06d33ab-d4ed-4f89-9a06-12d436ad34a6"],
Cell[CellGroupData[{
Cell[38662, 967, 440, 12, 51, "Input",ExpressionUUID->"d7992e24-a1b4-4a7d-9c2e-946da6fa1171"],
Cell[39105, 981, 1486, 35, 33, "Output",ExpressionUUID->"c4b34be5-6ab7-4af3-bf7b-57727b35a153"]
}, Open  ]],
Cell[40606, 1019, 276, 7, 29, "Input",ExpressionUUID->"1653ec4c-57ce-41e0-adc5-0a1a0477bbd1"],
Cell[40885, 1028, 151, 3, 29, "Input",ExpressionUUID->"a20753ff-356d-4b99-879a-681b7bdf8200"],
Cell[41039, 1033, 163, 2, 29, "Input",ExpressionUUID->"8ddfbf47-b850-4774-87e1-a77ba17c0c8d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41251, 1041, 177, 3, 68, "Section",ExpressionUUID->"e6543f7b-5b18-4af8-987b-12093bbca74d"],
Cell[CellGroupData[{
Cell[41453, 1048, 184, 3, 54, "Subsection",ExpressionUUID->"1c58b345-9c88-4fd6-8ca2-1454b3fb7115"],
Cell[41640, 1053, 4108, 122, 138, "Input",ExpressionUUID->"31f9484b-0cfd-48a5-a14e-b9e6d6826241"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

