(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    102485,       2740]
NotebookOptionsPosition[     90158,       2527]
NotebookOutlinePosition[     90576,       2544]
CellTagsIndexPosition[     90533,       2541]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Thesis", "Title",
 CellChangeTimes->{{3.8484094160890303`*^9, 
  3.8484094300517*^9}},ExpressionUUID->"2dc5b104-8e2d-4468-bcf4-8210550113b1"],

Cell[CellGroupData[{

Cell["Functions and imports", "Chapter",
 CellChangeTimes->{{3.848409446442876*^9, 
  3.848409466827778*^9}},ExpressionUUID->"20cc9388-4870-4d51-aae4-\
f3782afccc7e"],

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<CoolTools`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<Carlos`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<Quantum`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ItppVectorToExpression", "[", "vector_String", "]"}], " ", ":=", 
  " ", "\n", " ", 
  RowBox[{"ToExpression", " ", "/@", " ", "\n", "  ", 
   RowBox[{"StringSplit", "[", "\n", "   ", 
    RowBox[{"StringReplace", "[", "\n", "    ", 
     RowBox[{
      RowBox[{"StringTake", "[", 
       RowBox[{"vector", ",", " ", 
        RowBox[{"{", 
         RowBox[{"2", ",", " ", 
          RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<i\>\"", " ", "->", " ", "\"\<I\>\""}], ",", " ", 
        RowBox[{"\"\<e+\>\"", " ", ":>", " ", "\"\<*^\>\""}], ",", " ", "\n", 
        "     ", 
        RowBox[{"\"\<e-\>\"", " ", ":>", " ", "\"\<*^-\>\""}]}], "}"}]}], 
     "]"}], "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.848409332704856*^9, 3.848409390179282*^9}, {
  3.8484099022044907`*^9, 3.8484099295336037`*^9}, {3.8520481190198793`*^9, 
  3.8520481360913258`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"b7248f51-c213-4fe4-8d0e-cc4469fb660e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Pauli2Basis", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Pauli", "[", 
        RowBox[{"{", 
         RowBox[{"i", ",", "j"}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "3"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixToLatex", "[", "matrix_", "]"}], ":=", 
  RowBox[{"\"\<\\\\begin{pmatrix}\>\"", "<>", 
   RowBox[{"Fold", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"#1", "<>", "\"\<\\\\\>\"", "<>", "\"\<\\\\\>\"", "<>", "#2"}],
        ")"}], "&"}], ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Fold", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToString", "[", "#1", "]"}], "<>", "\"\<&\>\"", "<>", 
             RowBox[{"ToString", "[", "#2", "]"}]}], ")"}], "&"}], ",", "#"}],
          "]"}], "&"}], ",", "matrix"}], "]"}]}], "]"}], "<>", 
   "\"\<\\\\end{pmatrix}\>\""}]}], "\[IndentingNewLine]", "Dag"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8518142692573433`*^9, 3.851814282448141*^9}, {
   3.851814337190424*^9, 3.851814494822578*^9}, {3.8518147023915863`*^9, 
   3.8518147239404097`*^9}, {3.851855165460207*^9, 3.851855236300366*^9}, {
   3.851855274790909*^9, 3.8518553295711308`*^9}, 3.851858002983226*^9, {
   3.851858428663006*^9, 3.8518584305146933`*^9}, {3.851865505465664*^9, 
   3.851865528808473*^9}, {3.851973435648346*^9, 3.851973441856288*^9}, {
   3.85267677979837*^9, 
   3.852676781203766*^9}},ExpressionUUID->"76c48127-75ee-4739-838f-\
0178c17b6bb4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Early tests dec/21", "Chapter",
 CellChangeTimes->{{3.848409482506979*^9, 
  3.848409493698043*^9}},ExpressionUUID->"501dca48-d6de-4637-bec3-\
02854ac8d422"],

Cell[CellGroupData[{

Cell["SWAP", "Subsection",
 CellChangeTimes->{{3.84841161761296*^9, 
  3.84841161814036*^9}},ExpressionUUID->"3c7ef3b2-de0e-4d03-9636-\
62eda8c7e373"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"p", "=", "0.3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rz", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"states1", "=", 
   RowBox[{"ketsToDensity", "[", 
    RowBox[{
    "Get", "[", 
     "\"\<<brutal_data/pureHaarStates_n=10000_p=0.3_eps=0.01_rz=0.5.m\>\"", 
     "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.84840950495512*^9, 3.848409506302185*^9}, {
  3.8484098736817303`*^9, 3.8484098989315453`*^9}, {3.848409968524027*^9, 
  3.848409977316373*^9}, {3.848410382864509*^9, 3.848410396662739*^9}, {
  3.848411722255972*^9, 
  3.848411723286765*^9}},ExpressionUUID->"6ee24912-cb1d-4394-8854-\
d6152aaa80a0"],

Cell[BoxData[
 TemplateBox[{
  "Get", "noopen", 
   "\"Cannot open \
\\!\\(\\*RowBox[{\\\"\\\\\\\"brutal_data/pureHaarStates_n=10000_p=0.3_eps=0.\
01_rz=0.5.m\\\\\\\"\\\"}]\\).\"", 2, 9, 6, 30353164126932138630, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.848411717519595*^9},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"157ae39b-a218-4b5a-aeda-d68089a415ce"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"visualizeBipartiteSystem", "[", 
  RowBox[{"states1", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "500"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8484099943867493`*^9, 3.848410017414588*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"ddb3e758-a2d5-423d-b7a1-20524a8aa90f"],

Cell[BoxData[
 RowBox[{"visualizeBipartiteSystem", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"swapGate", ".", "#", ".", "swapGate"}], ")"}], "&"}], "/@", 
   RowBox[{"states1", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "500"}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.848410108573241*^9, 3.848410152894396*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"2bd032b2-043c-42cb-85c3-c70feb809abd"],

Cell["SWAP just swaps the particles", "Text",
 CellChangeTimes->{{3.848410802803851*^9, 
  3.848410819079818*^9}},ExpressionUUID->"d06fade2-1ff1-4a1a-92a0-\
d44bd0323cf7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"average1", "=", 
   RowBox[{"Mean", "[", "states1", "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{"average1", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.848410181435869*^9, 3.848410193364257*^9}, {
  3.848410253589974*^9, 3.848410264082327*^9}, {3.848410340659321*^9, 
  3.848410343892579*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"0e7e0517-fcee-4e84-bd9a-f3eb7ad91d14"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.47330471623149206`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0006556058128154614`", "\[VeryThinSpace]", "+", 
       RowBox[{"2.845314050949388`*^-6", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0003180894120928464`"}], "-", 
       RowBox[{"0.001522397709784926`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.003316964273691198`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.0014535666323710326`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.0006556058128154614`", "\[VeryThinSpace]", "-", 
       RowBox[{"2.845314050949388`*^-6", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.05425072873272882`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.08681210456737849`"}], "-", 
       RowBox[{"0.0005789894196643996`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.00009248542056647788`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00031019080880297344`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.0003180894120928464`"}], "+", 
       RowBox[{"0.001522397709784926`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.08681210456737849`"}], "+", 
       RowBox[{"0.0005789894196643996`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3719361130700104`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0005404181954919306`"}], "+", 
       RowBox[{"0.0004986216342479724`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.003316964273691198`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0014535666323710326`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.00009248542056647788`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.00031019080880297344`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0005404181954919306`"}], "-", 
       RowBox[{"0.0004986216342479724`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.10050844196998338`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.848410259429351*^9, 3.8484102643718033`*^9}, 
   3.8484103450578613`*^9},
 CellLabel->
  "Out[24]//MatrixForm=",ExpressionUUID->"3ca054bf-e4a4-4c6f-a573-\
70655af8013f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rho0", "=", 
   RowBox[{"coarseGraining2", "[", 
    RowBox[{"average1", ",", "p"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rho0", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[38]:=",ExpressionUUID->"2acc475c-be61-44c0-b89e-e9776d23736e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.7499352140003179`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.000012950134668560987`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.00001263520648534048`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.000012950134668560987`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00001263520648534048`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25006478600389664`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.848410513300302*^9},
 CellLabel->
  "Out[39]//MatrixForm=",ExpressionUUID->"f39ef42b-05c4-48b3-9359-\
679c67d1ae6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"average2", "=", 
   RowBox[{"Mean", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"swapGate", ".", "#", ".", "swapGate"}], ")"}], "&"}], "/@", 
     "states1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"average2", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.84841030335181*^9, 3.848410359818789*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"02d0096e-246a-40a9-a39d-f8a3a5f6dfe5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.47330471623149206`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0003180894120928464`"}], "-", 
       RowBox[{"0.001522397709784926`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0006556058128154614`", "\[VeryThinSpace]", "+", 
       RowBox[{"2.845314050949388`*^-6", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.003316964273691198`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.0014535666323710326`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.0003180894120928464`"}], "+", 
       RowBox[{"0.001522397709784926`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3719361130700104`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.08681210456737849`"}], "+", 
       RowBox[{"0.0005789894196643996`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0005404181954919306`"}], "+", 
       RowBox[{"0.0004986216342479724`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.0006556058128154614`", "\[VeryThinSpace]", "-", 
       RowBox[{"2.845314050949388`*^-6", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.08681210456737849`"}], "-", 
       RowBox[{"0.0005789894196643996`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.05425072873272882`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.00009248542056647788`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00031019080880297344`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.003316964273691198`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0014535666323710326`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0005404181954919306`"}], "-", 
       RowBox[{"0.0004986216342479724`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.00009248542056647788`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.00031019080880297344`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.10050844196998338`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8484103602497663`*^9},
 CellLabel->
  "Out[26]//MatrixForm=",ExpressionUUID->"aba115ba-d364-4fac-b83d-\
282e9637e69e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rhot", "=", 
   RowBox[{"coarseGraining2", "[", 
    RowBox[{"average2", ",", "p"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rhot", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.848410410911139*^9, 3.848410465776856*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"d0e96900-c560-4e11-bd97-6c99d4914556"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.6228610602654052`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0001233665088713987`"}], "-", 
       RowBox[{"0.0006981047461976903`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.0001233665088713987`"}], "+", 
       RowBox[{"0.0006981047461976903`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.37713893973880924`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.848410416420171*^9, {3.848410452586837*^9, 3.848410466223345*^9}},
 CellLabel->
  "Out[37]//MatrixForm=",ExpressionUUID->"35e9e700-722a-4105-b1f8-\
ccc76448324f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"densityMatrixToPoint", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"rho0", ",", "rhot"}], "}"}], ",", 
   RowBox[{"gellMannBasis", "[", "1", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8484106161597424`*^9, 3.8484106461743183`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"7718ce39-e976-42b1-99d6-59fe95016e37"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.000025900269337121975`", ",", "0.00002527041297068096`", ",", 
     "0.4998704279964213`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.0002467330177427974`"}], ",", "0.0013962094923953806`", 
     ",", "0.24572212052659598`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.848410646884573*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"b29d20bb-8cb5-4996-a76d-4f7539e90fdc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Norm", "/@", "%"}]], "Input",
 CellChangeTimes->{{3.848410655356351*^9, 3.848410665559198*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"bf5261f2-5f7f-4dc0-b574-00711640ec44"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.4998704293061784`", ",", "0.24572621104435655`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.848410665938931*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"1ad95e82-09e3-4d35-a82e-481515af7bc4"]
}, Open  ]],

Cell["\<\
This is an interesting result alrady, as rhot becomes a more mixed state. \
That means there is no unitary between rho anf rhot. \
\>", "Text",
 CellChangeTimes->{{3.848410671824737*^9, 
  3.84841074889701*^9}},ExpressionUUID->"57294b82-1047-4d61-b5d7-\
f47f57664993"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tr", "/@", 
  RowBox[{"{", 
   RowBox[{"average1", ",", "average2"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.848410751823626*^9, 3.8484107657878428`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"e028805f-552b-47ac-a355-3838dfe88545"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1.0000000000042146`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"1.0000000000042146`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.8484107660453033`*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"af20efff-0c8d-4b8a-8bba-4a87c40629d3"]
}, Open  ]],

Cell["Trace is preserved, that\[CloseCurlyQuote]s nice", "Text",
 CellChangeTimes->{{3.848410771896707*^9, 
  3.84841078915073*^9}},ExpressionUUID->"68d2991b-fb3a-41da-abf4-\
a8e8696fadaf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CNOT", "Subsection",
 CellChangeTimes->{{3.848411622779531*^9, 
  3.8484116232369223`*^9}},ExpressionUUID->"6811d892-d61b-4224-ba37-\
5efbb615aee0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CNOT", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", "0.3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rz", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"states1", "=", 
   RowBox[{"ketsToDensity", "[", 
    RowBox[{
    "Get", "[", 
     "\"\<brutal_data/pureHaarStates_n=10000_p=0.3_eps=0.01_rz=0.5.m\>\"", 
     "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.848411625688918*^9, 3.8484116773499327`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"d92a96c8-c1de-428b-a95b-3e274f5ae8f8"],

Cell[BoxData[
 RowBox[{"visualizeBipartiteSystem", "[", 
  RowBox[{"states1", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "1000"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.848411777584407*^9, 3.848411787325716*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"e0e06cba-7ea5-481e-9910-20fa7ae75bcd"],

Cell[BoxData[
 RowBox[{"visualizeBipartiteSystem", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"CNOT", ".", "#", ".", "CNOT"}], ")"}], "&"}], "/@", 
   RowBox[{"states1", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "1000"}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.848411691613344*^9, 3.848411695524786*^9}, {
  3.848411790992363*^9, 3.848411791510869*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"3135e394-d186-4462-907b-555fee0dec51"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Kraus operators jan/22", "Chapter",
 CellChangeTimes->{{3.851032872623541*^9, 
  3.851032915225951*^9}},ExpressionUUID->"cbcce0b4-1171-4747-9da3-\
e21114656bb0"],

Cell["Let some Kraus operators for the CG map be", "Text",
 CellChangeTimes->{{3.851032938666698*^9, 
  3.851032967074058*^9}},ExpressionUUID->"e056893b-f16e-4be1-bf6a-\
dd4ae65a9f0f"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"CGKraus", ",", "CGKrausOp"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CGKrausOp", "[", "p_", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Sqrt", "[", "p", "]"}], 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Sqrt", "[", "p", "]"}], 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", "p"}], "]"}], 
      RowBox[{
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ".", "swapGate"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", "p"}], "]"}], 
      RowBox[{
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ".", "swapGate"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CGKraus", "[", 
    RowBox[{"rho_", ",", "p_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"kr", "=", 
       RowBox[{"CGKrausOp", "[", "p", "]"}]}], "}"}], ",", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", ".", "rho", ".", 
          RowBox[{"ConjugateTranspose", "[", "#", "]"}]}], ")"}], "&"}], "/@",
        "kr"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.851032969543889*^9, 3.8510330888151207`*^9}, {
  3.851033306443892*^9, 3.851033339863718*^9}, {3.8510333766283083`*^9, 
  3.851033445660818*^9}, {3.851033483204488*^9, 3.851033563309897*^9}, {
  3.851033676968577*^9, 3.851033709604796*^9}, {3.851074411273024*^9, 
  3.851074424408942*^9}, {3.851074784396276*^9, 3.851074793962289*^9}, {
  3.851074926666666*^9, 3.851074936892797*^9}, {3.851541780248951*^9, 
  3.851541780819128*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"a5e4566a-7e71-43c6-963f-96f7de53223e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"CGKrausOp", "[", "p", "]"}]}]], "Input",
 CellChangeTimes->{{3.851541796684163*^9, 3.8515418219019413`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"2692ff5c-2dda-480c-8a91-13b8152677f9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        SqrtBox["p"], "0", "0", "0"},
       {"0", "0", 
        SqrtBox["p"], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        SqrtBox["p"], "0", "0"},
       {"0", "0", "0", 
        SqrtBox["p"]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        SqrtBox[
         RowBox[{"1", "-", "p"}]], "0", "0", "0"},
       {"0", 
        SqrtBox[
         RowBox[{"1", "-", "p"}]], "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        SqrtBox[
         RowBox[{"1", "-", "p"}]], "0"},
       {"0", "0", "0", 
        SqrtBox[
         RowBox[{"1", "-", "p"}]]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{3.851541805736094*^9, 3.851542864127439*^9, 
  3.8518111328941317`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"20001aab-03d4-4901-aa80-e45dfae92bcc"]
}, Open  ]],

Cell["Let\[CloseCurlyQuote]s see if these Kraus operators are correct", "Text",
 CellChangeTimes->{{3.851865841404972*^9, 
  3.851865854986637*^9}},ExpressionUUID->"95e221f0-fdef-42c8-86e1-\
f75f730d9ab2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptest", "=", "0.3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vtest", "=", 
   RowBox[{"Venv", "[", "ptest", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhotest", "=", 
   RowBox[{
    RowBox[{"ketsToDensity", "[", 
     RowBox[{"{", 
      RowBox[{"RandomState", "[", "4", "]"}], "}"}], "]"}], "//", "First"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cgtest", "=", 
   RowBox[{"coarseGraining2", "[", 
    RowBox[{"rhotest", ",", "ptest"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kraustest", "=", 
   RowBox[{"CGKraus", "[", 
    RowBox[{"rhotest", ",", "ptest"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"cgtest", "==", "kraustest"}]}], "Input",
 CellChangeTimes->{{3.851865867634493*^9, 3.851865867932355*^9}, {
  3.851865912183197*^9, 3.851865963938621*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"889528e2-f48d-494c-abd6-d4e06b7fdcdb"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.851865960832252*^9, 3.8518659643879013`*^9}},
 CellLabel->"Out[79]=",ExpressionUUID->"b08163f0-0d7c-460f-8f92-519491de2c96"]
}, Open  ]],

Cell["\<\
Now let\[CloseCurlyQuote]s obtain the auxiliary unitary. We just use the \
before mentioned operators and we complete the martix. \
\>", "Text",
 CellChangeTimes->{{3.851075131096322*^9, 3.851075138868061*^9}, {
   3.851542878690666*^9, 3.8515428977227383`*^9}, 
   3.851865121073359*^9},ExpressionUUID->"cb22fa1e-4c8a-49a7-8561-\
944371c8484c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Venv", "[", "p_", "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sqrt", "[", "p", "]"}], ",", "0", ",", "0", ",", "0", ",", "0",
       ",", "0", ",", "0", ",", 
      RowBox[{"-", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "p"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"Sqrt", "[", "p", "]"}], ",", "0", ",", "0", ",", "0", ",", 
      RowBox[{"-", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "p"}], "]"}]}], ",", "0"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"Sqrt", "[", "p", "]"}], ",", "0", ",", "0", ",", "0", ",", 
      RowBox[{"-", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "p"}], "]"}]}], ",", "0", ",", "0"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", 
      RowBox[{"Sqrt", "[", "p", "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "p"}], "]"}]}], ",", "0", ",", "0", ",", "0"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", "p"}], "]"}], ",", "0", ",", "0", ",", "0", ",", "0",
       ",", "0", ",", "0", ",", 
      RowBox[{"Sqrt", "[", "p", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", "p"}], "]"}], ",", "0", ",", "0", ",", "0", ",", 
      RowBox[{"Sqrt", "[", "p", "]"}], ",", "0", ",", "0"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", "p"}], "]"}], ",", "0", ",", "0", ",", "0", ",", 
      RowBox[{"Sqrt", "[", "p", "]"}], ",", "0"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", "p"}], "]"}], ",", 
      RowBox[{"Sqrt", "[", "p", "]"}], ",", "0", ",", "0", ",", "0"}], 
     "}"}]}], "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.8510751414082937`*^9, 3.8510751454929237`*^9}, {
   3.851076027123075*^9, 3.851076078539562*^9}, {3.8515429045868483`*^9, 
   3.851542917330909*^9}, {3.851543092667486*^9, 3.851543364279196*^9}, {
   3.851547320373967*^9, 3.8515473306347017`*^9}, {3.851547458395879*^9, 
   3.851547661715172*^9}, 3.8515532837086782`*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"d19c4c51-9522-4c25-a173-fcbf684860f1"],

Cell["Let\[CloseCurlyQuote]s just make sure that it works as intended", "Text",
 CellChangeTimes->{{3.851865190691524*^9, 
  3.851865210627483*^9}},ExpressionUUID->"4a428d77-c504-4910-9b52-\
9b9679070a7d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptest", "=", "0.3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vtest", "=", 
   RowBox[{"Venv", "[", "ptest", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhotest", "=", 
   RowBox[{
    RowBox[{"ketsToDensity", "[", 
     RowBox[{"{", 
      RowBox[{"RandomState", "[", "4", "]"}], "}"}], "]"}], "//", "First"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cgtest", "=", 
   RowBox[{"coarseGraining2", "[", 
    RowBox[{"rhotest", ",", "ptest"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"unitest", "=", 
   RowBox[{"PartialTrace", "[", 
    RowBox[{
     RowBox[{"Vtest", ".", 
      RowBox[{"(", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"rhotest", ",", 
         RowBox[{"First", "[", 
          RowBox[{"ketsToDensity", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], "}"}], "]"}], "]"}]}], "]"}], 
       ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", "Vtest", "]"}]}], ",", "1"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.851865219055784*^9, 3.851865247660833*^9}, {
  3.851865279303117*^9, 3.851865382362357*^9}, {3.8518654644241657`*^9, 
  3.8518654798699493`*^9}, {3.851865640674451*^9, 3.851865652134151*^9}, {
  3.851865708966329*^9, 3.8518657326237803`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"11da57ad-ec6f-48b5-856e-ed11eec40ac6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cgtest", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.851865654447605*^9, 3.851865671345392*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"5bb28f06-766e-48c1-b045-0b48e5c98978"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.5883564874976241`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.04328546247635051`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0687477644622645`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.04328546247635051`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.0687477644622645`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.41164351250237574`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8518656554477453`*^9, 3.851865671623563*^9}, 
   3.851865736048088*^9},
 CellLabel->
  "Out[52]//MatrixForm=",ExpressionUUID->"d06b18dd-f777-4e8f-aba9-\
7bb901d80a1c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"unitest", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.851865673462817*^9, 3.8518656778235617`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"f9b640a8-7342-43fe-9222-f10430d4678a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.2866476488073852`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.734723475976807`*^-18", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.12025893929608736`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.06885863093309472`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.12025893929608736`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.06885863093309474`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.7133523511926146`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.734723475976807`*^-18", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8518656780961637`*^9, 3.851865737529642*^9},
 CellLabel->
  "Out[53]//MatrixForm=",ExpressionUUID->"7260649e-946f-4c87-96a8-\
851fc4d8b5fb"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"p", "=", "0.8"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Venv", "[", "p", "]"}], ".", 
   RowBox[{"ConjugateTranspose", "[", 
    RowBox[{"Venv", "[", "p", "]"}], "]"}]}], "//", " ", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "p", "]"}]}], "Input",
 CellChangeTimes->{{3.851543373344432*^9, 3.851543418819305*^9}, {
  3.851543480501691*^9, 3.851543482551805*^9}, {3.8515439017937117`*^9, 
  3.851543910431889*^9}, {3.851547692838561*^9, 3.851547693010762*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"e548d8b7-016a-46af-831a-e8e0bc77bd26"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixToLatex", "[", 
  RowBox[{"Venv", "[", "p", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.851863427524815*^9, 3.851863439543247*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"5fd91e88-8106-47f8-9835-2825844aba6d"],

Cell[BoxData["\<\"\\\\begin{pmatrix}Sqrt[p]&0&0&0&0&0&0&-Sqrt[1 - \
p]\\\\\\\\0&0&Sqrt[p]&0&0&0&-Sqrt[1 - p]&0\\\\\\\\0&Sqrt[p]&0&0&0&-Sqrt[1 - \
p]&0&0\\\\\\\\0&0&0&Sqrt[p]&-Sqrt[1 - p]&0&0&0\\\\\\\\Sqrt[1 - \
p]&0&0&0&0&0&0&Sqrt[p]\\\\\\\\0&Sqrt[1 - \
p]&0&0&0&Sqrt[p]&0&0\\\\\\\\0&0&Sqrt[1 - \
p]&0&0&0&Sqrt[p]&0\\\\\\\\0&0&0&Sqrt[1 - \
p]&Sqrt[p]&0&0&0\\\\end{pmatrix}\"\>"], "Output",
 CellChangeTimes->{{3.8515433926950893`*^9, 3.851543419058497*^9}, 
   3.851543482831586*^9, 3.851543910853848*^9, {3.8515476850839767`*^9, 
   3.851547693359071*^9}, 3.85181115285165*^9, {3.8518634401014767`*^9, 
   3.851863446156715*^9}},
 CellLabel->"Out[13]=",ExpressionUUID->"b017267f-74d3-4656-ac4c-7040f43206de"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tarea 1 - dominio de \[Gamma] para \[Rho] puro", "Chapter",
 CellChangeTimes->{{3.8519735372680607`*^9, 
  3.85197357999413*^9}},ExpressionUUID->"fd175aa6-bbe4-4667-8266-\
b9fd1bf55275"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pureket", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"t", "/", "2"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"t", "/", "2"}], "]"}], "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], "*", "p"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"purerho", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Refine", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ketsToDensity", "[", 
        RowBox[{"{", "pureket", "}"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Element", "[", 
         RowBox[{"t", ",", "Reals"}], "]"}], ",", 
        RowBox[{"Element", "[", 
         RowBox[{"p", ",", "Reals"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"psi", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Refine", "[", 
     RowBox[{
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"purerho", ",", "purerho"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Element", "[", 
         RowBox[{"t", ",", "Reals"}], "]"}], ",", 
        RowBox[{"Element", "[", 
         RowBox[{"p", ",", "Reals"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"purebbv", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"densityMatrixToPoint", "[", 
      RowBox[{
       RowBox[{"{", "psi", "}"}], ",", 
       RowBox[{"gellMannBasis", "[", "2", "]"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"puresbv", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"densityMatrixToPoint", "[", 
      RowBox[{
       RowBox[{"{", "purerho", "}"}], ",", 
       RowBox[{"gellMannBasis", "[", "1", "]"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Expand", "[", "puresbv", "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.851973583663827*^9, 3.8519736780179243`*^9}, {
  3.851973734241086*^9, 3.851973875387505*^9}, {3.851976677557383*^9, 
  3.85197673098251*^9}, {3.8519767673264647`*^9, 3.851976780413642*^9}, {
  3.851976818128777*^9, 3.851976819237028*^9}, {3.851976996277224*^9, 
  3.851977080576151*^9}, {3.851977816077168*^9, 3.851977890714238*^9}, {
  3.851977927423472*^9, 3.8519779557691107`*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"cc307c1d-64bc-48e0-9870-3ec1d6e19ccc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "p"}]], " ", 
         RowBox[{"Sin", "[", "t", "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "p"}]], " ", 
         RowBox[{"Sin", "[", "t", "]"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "p"}]], " ", 
         RowBox[{"Sin", "[", "t", "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "p"}]], " ", 
         RowBox[{"Sin", "[", "t", "]"}]}]}]},
      {
       RowBox[{"Cos", "[", "t", "]"}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.851977956734724*^9},
 CellLabel->
  "Out[74]//MatrixForm=",ExpressionUUID->"691e4910-5b2e-4a97-b318-\
84d31f6d9d9e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"psi", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.851977153629528*^9, 3.8519771579304533`*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"ff57c742-20b4-40a6-b43c-3eef534a4f3c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        FractionBox["t", "2"], "]"}], "4"], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "p"}]], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         FractionBox["t", "2"], "]"}], "3"], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["t", "2"], "]"}]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "p"}]], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         FractionBox["t", "2"], "]"}], "3"], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["t", "2"], "]"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "p"}]], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "t", "]"}], "2"]}]},
     {
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "p"}]], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         FractionBox["t", "2"], "]"}], "3"], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["t", "2"], "]"}]}], 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Sin", "[", "t", "]"}], "2"], "4"], 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Sin", "[", "t", "]"}], "2"], "4"], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "p"}]], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         FractionBox["t", "2"], "]"}], "2"], " ", 
       RowBox[{"Sin", "[", "t", "]"}]}]},
     {
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "p"}]], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         FractionBox["t", "2"], "]"}], "3"], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["t", "2"], "]"}]}], 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Sin", "[", "t", "]"}], "2"], "4"], 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Sin", "[", "t", "]"}], "2"], "4"], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "p"}]], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         FractionBox["t", "2"], "]"}], "2"], " ", 
       RowBox[{"Sin", "[", "t", "]"}]}]},
     {
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "p"}]], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "t", "]"}], "2"]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "p"}]], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         FractionBox["t", "2"], "]"}], "2"], " ", 
       RowBox[{"Sin", "[", "t", "]"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "p"}]], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         FractionBox["t", "2"], "]"}], "2"], " ", 
       RowBox[{"Sin", "[", "t", "]"}]}], 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        FractionBox["t", "2"], "]"}], "4"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.85197715821907*^9},
 CellLabel->
  "Out[45]//MatrixForm=",ExpressionUUID->"328c6ef6-9dc3-45ae-bcff-\
e24e25db2b00"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"densityMatrixToPoint", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"IdentityMatrix", "[", "4", "]"}], "}"}], ",", 
    RowBox[{"gellMannBasis", "[", "2", "]"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.851976830751461*^9, 3.8519768461966763`*^9}, {
  3.851977013030127*^9, 3.851977021730811*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"750ebe38-5761-4d1b-b7f5-0d8ffa5e67dd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8519769858089533`*^9, 3.851977022244548*^9}},
 CellLabel->"Out[31]=",ExpressionUUID->"709e60dd-5b1f-46f7-8728-8367de48f8f0"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Tarea 2 - ejemplo de correlaciones", "Chapter",
 CellChangeTimes->{{3.85155331382832*^9, 
  3.851553347409565*^9}},ExpressionUUID->"ba5c06e5-7aed-4143-b877-\
787c303587c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"psi0", "=", 
   RowBox[{
    RowBox[{"ketsToDensity", "[", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], "}"}], "]"}], "//",
     "First"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", "swapGate"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"Venv", "[", "p", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.85155335260363*^9, 3.851553422128888*^9}, {
   3.8515559820738707`*^9, 3.851555987535664*^9}, 3.851811170688361*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"9bb3dcf2-d4c2-4ca7-af57-4fe42e903d4a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"X0", "=", 
   RowBox[{
    RowBox[{"Venv", "[", "p", "]"}], ".", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"psi0", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ".", 
    RowBox[{"ConjugateTranspose", "[", 
     RowBox[{"Venv", "[", "p", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w0", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "4", "]"}], ",", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", "2", "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ".", "X0", ".", 
       RowBox[{"ConjugateTranspose", "[", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", "4", "]"}], ",", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "2", "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], "//", "Total"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wt", "=", 
   RowBox[{"V", ".", 
    RowBox[{"(", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"U", ",", 
       RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}], ")"}], ".", 
    RowBox[{"ConjugateTranspose", "[", "V", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "Wt", "]"}]}], "Input",
 CellChangeTimes->{{3.851553425459241*^9, 3.851553512813323*^9}, {
  3.8515535466911182`*^9, 3.851553554187625*^9}, {3.85155444467128*^9, 
  3.8515544637833757`*^9}, {3.851554664796781*^9, 3.851554745209014*^9}, {
  3.851554790149198*^9, 3.851554797913187*^9}, {3.8515548655298*^9, 
  3.851554881251576*^9}, {3.85155589925747*^9, 3.8515559187718687`*^9}, {
  3.851555968263783*^9, 3.851556039045333*^9}, {3.851556409021106*^9, 
  3.8515564225758343`*^9}, {3.851556485158677*^9, 3.851556486753591*^9}, {
  3.851812755012066*^9, 3.8518127610617733`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"64cab554-074c-4ac0-8766-4071fb6c9280"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{
  3.851812761882657*^9, {3.851865446292263*^9, 3.851865451585637*^9}},
 CellLabel->"Out[30]=",ExpressionUUID->"d81dc8f3-9cad-4294-b70e-74de65b32de5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["w0"], "Input",
 CellChangeTimes->{{3.851865442027207*^9, 3.851865444408246*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"6bd000d7-174e-4d1d-9edf-b2f947823afe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SqrtBox["p"], " ", 
      RowBox[{"Conjugate", "[", 
       SqrtBox["p"], "]"}]}], ",", "0", ",", 
     RowBox[{
      SqrtBox["p"], " ", 
      RowBox[{"Conjugate", "[", 
       SqrtBox[
        RowBox[{"1", "-", "p"}]], "]"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SqrtBox[
       RowBox[{"1", "-", "p"}]], " ", 
      RowBox[{"Conjugate", "[", 
       SqrtBox["p"], "]"}]}], ",", "0", ",", 
     RowBox[{
      SqrtBox[
       RowBox[{"1", "-", "p"}]], " ", 
      RowBox[{"Conjugate", "[", 
       SqrtBox[
        RowBox[{"1", "-", "p"}]], "]"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.851865452801188*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"2e653954-dba5-49f8-ba40-7ee7d8707e59"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eigensystem", "[", "w0", "]"}]], "Input",
 CellChangeTimes->{{3.851556089902604*^9, 3.851556094751258*^9}, {
  3.8515564298874187`*^9, 3.851556431339448*^9}, {3.851556483394535*^9, 
  3.851556487901964*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"b58bc46d-f297-4fb3-bf04-f942d7ef71c5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", "p"}]], " ", 
       RowBox[{"Conjugate", "[", 
        SqrtBox[
         RowBox[{"1", "-", "p"}]], "]"}]}], "+", 
      RowBox[{
       SqrtBox["p"], " ", 
       RowBox[{"Conjugate", "[", 
        SqrtBox["p"], "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"Conjugate", "[", 
          SqrtBox[
           RowBox[{"1", "-", "p"}]], "]"}], 
         RowBox[{"Conjugate", "[", 
          SqrtBox["p"], "]"}]]}], ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        SqrtBox["p"], 
        SqrtBox[
         RowBox[{"1", "-", "p"}]]], ",", "0", ",", "1", ",", "0"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.851556095432333*^9, {3.851556419790337*^9, 3.8515564319856377`*^9}, 
   3.851556573919447*^9, 3.851811452979319*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"3182e048-7610-410c-9525-3978eb9f145d"]
}, Open  ]],

Cell["\<\
We now know that w0 is actually a pure state. Let\[CloseCurlyQuote]s contract \
Wt:\
\>", "Text",
 CellChangeTimes->{{3.851556607644414*^9, 3.851556682338111*^9}, {
  3.8518125979141827`*^9, 
  3.851812621288631*^9}},ExpressionUUID->"baf7684b-4781-4780-924b-\
7ad83cc32911"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Sqrt", "[", "p", "]"}], ",", "0", ",", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "-", "p"}], "]"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{
    RowBox[{"ConjugateTranspose", "[", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{"phi", ",", 
       RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}], "]"}], ".", "Wt", 
    ".", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"phi", ",", 
      RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}]}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.851812626586754*^9, 3.8518127047551603`*^9}, {
  3.851812791993206*^9, 3.851812810604327*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"9208784e-eee2-4674-b514-3a8ccfdffcc2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"M", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.851812820634869*^9, 3.851812828365087*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"c9a1bb4f-2800-4b84-a647-8fc583a3a9a3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", "p"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "[", 
            SqrtBox["p"], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SqrtBox["p"], " ", 
              RowBox[{"Conjugate", "[", 
               SqrtBox[
                RowBox[{"1", "-", "p"}]], "]"}]}], "-", 
             RowBox[{
              SqrtBox[
               RowBox[{"1", "-", "p"}]], " ", 
              RowBox[{"Conjugate", "[", 
               SqrtBox["p"], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            SqrtBox[
             RowBox[{"1", "-", "p"}]], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SqrtBox[
               RowBox[{"1", "-", "p"}]], " ", 
              RowBox[{"Conjugate", "[", 
               SqrtBox[
                RowBox[{"1", "-", "p"}]], "]"}]}], "+", 
             RowBox[{
              SqrtBox["p"], " ", 
              RowBox[{"Conjugate", "[", 
               SqrtBox["p"], "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SqrtBox["p"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "[", 
            SqrtBox[
             RowBox[{"1", "-", "p"}]], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SqrtBox["p"]}], " ", 
              RowBox[{"Conjugate", "[", 
               SqrtBox[
                RowBox[{"1", "-", "p"}]], "]"}]}], "+", 
             RowBox[{
              SqrtBox[
               RowBox[{"1", "-", "p"}]], " ", 
              RowBox[{"Conjugate", "[", 
               SqrtBox["p"], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            SqrtBox["p"], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SqrtBox[
               RowBox[{"1", "-", "p"}]], " ", 
              RowBox[{"Conjugate", "[", 
               SqrtBox[
                RowBox[{"1", "-", "p"}]], "]"}]}], "+", 
             RowBox[{
              SqrtBox["p"], " ", 
              RowBox[{"Conjugate", "[", 
               SqrtBox["p"], "]"}]}]}], ")"}]}]}], ")"}]}]}], "0"},
     {"0", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "p"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Conjugate", "[", 
          SqrtBox[
           RowBox[{"1", "-", "p"}]], "]"}], "2"]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", "p"}]], " ", 
        SqrtBox["p"], " ", 
        RowBox[{"Conjugate", "[", 
         SqrtBox[
          RowBox[{"1", "-", "p"}]], "]"}], " ", 
        RowBox[{"Conjugate", "[", 
         SqrtBox["p"], "]"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.851812828627035*^9},
 CellLabel->
  "Out[39]//MatrixForm=",ExpressionUUID->"ee88b77b-907b-4be7-83c2-\
2d58246ac2ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Refine", "[", 
   RowBox[{"M", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Element", "[", 
       RowBox[{"p", ",", "Reals"}], "]"}], ",", 
      RowBox[{"p", ">", "0"}], ",", 
      RowBox[{"p", "<", "1"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8518129142988043`*^9, 3.851812937188753*^9}, {
  3.851812972195826*^9, 3.851812972500586*^9}, {3.8518130627353563`*^9, 
  3.851813127286736*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"aada69b4-d270-463e-a8c5-77d7eb0ce96f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {"0", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "p"}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "p"}], ")"}], " ", "p"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.851812943103891*^9, {3.8518130653499517`*^9, 3.851813087441667*^9}, {
   3.8518131213217897`*^9, 3.8518131275722837`*^9}},
 CellLabel->
  "Out[44]//MatrixForm=",ExpressionUUID->"93008ce9-5f1b-43a8-8310-\
fcf2f1c14d27"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"Refine", "[", 
     RowBox[{
      RowBox[{"M", ".", 
       RowBox[{"ConjugateTranspose", "[", "M", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Element", "[", 
         RowBox[{"p", ",", "Reals"}], "]"}], ",", 
        RowBox[{"p", ">", "0"}], ",", 
        RowBox[{"p", "<", "1"}]}], "}"}]}], "]"}], "]"}], "//", 
   "MatrixForm"}], "\n"}]], "Input",
 CellChangeTimes->{{3.851812911680119*^9, 3.851812939899392*^9}, {
  3.8518132325289173`*^9, 3.851813268248251*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"a3648826-7307-406c-a1aa-3f7633909970"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {"0", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "p"}], ")"}], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8518132425488157`*^9, 3.851813268781477*^9}},
 CellLabel->
  "Out[47]//MatrixForm=",ExpressionUUID->"9f2a4bcd-23b1-4d23-ad7c-\
54259e654691"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"w0", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.851554750844352*^9, 3.851554754258025*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"123bacb0-9fcd-48a1-94a7-76dc8ac469a3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SqrtBox["p"], " ", 
       RowBox[{"Conjugate", "[", 
        SqrtBox["p"], "]"}]}], "0", 
      RowBox[{
       SqrtBox["p"], " ", 
       RowBox[{"Conjugate", "[", 
        SqrtBox[
         RowBox[{"1", "-", "p"}]], "]"}]}], "0"},
     {"0", "0", "0", "0"},
     {
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", "p"}]], " ", 
       RowBox[{"Conjugate", "[", 
        SqrtBox["p"], "]"}]}], "0", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", "p"}]], " ", 
       RowBox[{"Conjugate", "[", 
        SqrtBox[
         RowBox[{"1", "-", "p"}]], "]"}]}], "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.851554754505671*^9, 3.851555923249427*^9},
 CellLabel->
  "Out[35]//MatrixForm=",ExpressionUUID->"b58283a0-2b8c-4cee-83aa-\
b53988940b3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"KroneckerProduct", "[", 
   RowBox[{"phi", ",", 
    RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8518127098896103`*^9, 3.851812713923602*^9}, {
  3.851812765621284*^9, 3.8518127813366823`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"1e8782e9-2b4e-49e1-a0ce-c44be26d9b57"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SqrtBox["p"], "0"},
     {"0", 
      SqrtBox["p"]},
     {"0", "0"},
     {"0", "0"},
     {
      SqrtBox[
       RowBox[{"1", "-", "p"}]], "0"},
     {"0", 
      SqrtBox[
       RowBox[{"1", "-", "p"}]]},
     {"0", "0"},
     {"0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.851812772509563*^9, 3.851812781602524*^9}},
 CellLabel->
  "Out[36]//MatrixForm=",ExpressionUUID->"74bbedbc-6842-458a-8dd6-\
aacc1761fb12"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Pauli", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.8518140115908947`*^9, 3.851814082362794*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"360696f0-dfc1-408c-840b-d673cd95bad6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.851814018482547*^9, 3.851814082949724*^9}},
 CellLabel->"Out[53]=",ExpressionUUID->"c05cb8b5-915c-4bef-97c7-3a3d4015193c"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8518140920054283`*^9, 
  3.8518140953405533`*^9}},ExpressionUUID->"2b2fd963-ffe1-48df-af06-\
7ce06823a1a1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Tarea 3num - dominio, SWAP, identidad", "Chapter",
 CellChangeTimes->{{3.852046212752986*^9, 
  3.852046271554843*^9}},ExpressionUUID->"68a388df-bdb2-4f72-9b0a-\
481de7fbd23e"],

Cell[CellGroupData[{

Cell["Early testing", "Section",
 CellChangeTimes->{{3.852676899415682*^9, 
  3.85267690516792*^9}},ExpressionUUID->"8d116cde-2272-4fdb-b99b-\
b80449b38f1a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"purestates", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomState", "[", "2", "]"}], ",", "5000"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"purebv", "=", 
   RowBox[{"densityMatrixToPoint", "[", 
    RowBox[{
     RowBox[{"ketsToDensity", "[", "purestates", "]"}], ",", 
     RowBox[{"gellMannBasis", "[", "1", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mixedbv", "=", 
   RowBox[{"0.9", "*", "purebv"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPointPlot3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"purebv", ",", "mixedbv"}], "}"}], ",", 
   RowBox[{"BoxRatios", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}]}], "]"}]}], "Input",\

 CellChangeTimes->{{3.852046297103911*^9, 3.852046302354423*^9}, {
  3.852046509367135*^9, 3.852046669629483*^9}, {3.852046949395198*^9, 
  3.8520469904552794`*^9}, {3.852047171644009*^9, 3.852047171722746*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"e9f3d30b-0527-4f91-88bc-953eae920a21"],

Cell["\<\
Well here\[CloseCurlyQuote]s la bronca: how am I supposed to obtain the \
assignement map for a thousand states? Didn\[CloseCurlyQuote]t think of that. \
I will run some test using the brutal method from Carlos and Erick but I don\
\[CloseCurlyQuote]t think it\[CloseCurlyQuote]s doable. \
\>", "Text",
 CellChangeTimes->{{3.852047405797207*^9, 
  3.852047501004991*^9}},ExpressionUUID->"e471d57b-1a39-4d84-8612-\
cab420828c16"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Parameters", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"SampleSize", " ", "=", " ", "100"}], ",", "\n", "   ", 
      RowBox[{"rz", " ", "=", " ", "0.9"}], ",", "\n", "   ", 
      RowBox[{"MaxError", " ", "=", " ", "0.01"}], ",", "\n", "   ", 
      RowBox[{"SwapProbability", " ", "=", " ", "0.5"}]}], "}"}]}], ";"}], 
  "\n", "   "}], "\n", 
 RowBox[{
  RowBox[{"preasign", " ", "=", " ", 
   RowBox[{"ItppVectorToExpression", " ", "/@", " ", 
    RowBox[{"(", 
     RowBox[{"RAW", " ", "=", " ", "\n", "     ", 
      RowBox[{"ReadListUncomment", "[", "\n", "      ", 
       RowBox[{
        RowBox[{
        "\"\<!/home/acastillo/Documents/adanerick/codigo/cg -o \
get_states_bruto -s 0 --swap_probability \>\"", " ", "<>", " ", "\n", 
         "       ", 
         RowBox[{"ToString", "[", "SwapProbability", "]"}], " ", "<>", " ", 
         "\"\< --max_tolerance \>\"", " ", "<>", " ", "\n", "       ", 
         RowBox[{"ToString", "[", "MaxError", "]"}], " ", "<>", " ", 
         "\"\< --sample_size \>\"", " ", "<>", " ", "\n", "       ", 
         RowBox[{"ToString", "[", "SampleSize", "]"}], " ", "<>", " ", 
         "\"\< --r_z \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", "rz", "]"}]}], ",", " ", "String"}], 
       "]"}]}], ")"}]}]}], ";"}]}], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.842119023154624*^9, 3.84211902320464*^9}, {
   3.842119056240877*^9, 3.842119098262333*^9}, {3.842119155051704*^9, 
   3.8421191721464043`*^9}, {3.8421193306561127`*^9, 3.842119343725539*^9}, {
   3.842119478436363*^9, 3.842119526928413*^9}, {3.842342735951173*^9, 
   3.842342741070971*^9}, {3.842342794588936*^9, 3.842342823367249*^9}, 
   3.8423429909986877`*^9, {3.8423483568690863`*^9, 3.842348357020755*^9}, {
   3.842348517846774*^9, 3.8423485182604313`*^9}, {3.842351219267847*^9, 
   3.842351222621298*^9}, {3.842354016064673*^9, 3.8423540167135344`*^9}, {
   3.842357533394424*^9, 3.842357533730053*^9}, {3.842362489398979*^9, 
   3.842362510944159*^9}, {3.8423772684810677`*^9, 3.8423772847407513`*^9}, {
   3.8477415858895073`*^9, 3.8477415924099073`*^9}, {3.8478926656606283`*^9, 
   3.847892675524476*^9}, {3.852058791692719*^9, 3.8520587917753*^9}, {
   3.852058827264635*^9, 3.852058849151013*^9}, {3.852059328535788*^9, 
   3.8520593570422993`*^9}},ExpressionUUID->"69a7b947-7b97-4fda-a47f-\
f04511bbf0c3"],

Cell[CellGroupData[{

Cell[BoxData["d2"], "Input",
 CellChangeTimes->{{3.852059086058484*^9, 3.852059086652136*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"d50572f9-be7a-4bab-8e65-b2e5a915cec6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.162883`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.852059088085442*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"55a4d5fe-8841-465c-9ed2-4b60c62cd75a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "d2", "]"}]], "Input",
 CellChangeTimes->{{3.852058729963252*^9, 3.852058733742303*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"59257c2e-bebb-4ac6-af2a-2920de9b5402"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"100", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.8520587509174147`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"1d97b8cf-2d8a-4c40-af1a-cc23a47e48ec"]
}, Open  ]],

Cell["\<\
Well the brutal method is painfully slow, and it actually only works for \
states in de z axis. That\[CloseCurlyQuote]s not a problem tho, as any two \
pure states are related by an unitary. Let\[CloseCurlyQuote]s say we want to \
obtain the asignement states for a random coarse state. We would obtain the \
asignement states for a z-state (coarse) and then apply the unitary that \
relates the original coarse state to the z-state to all of them. Since the \
z-state is of the form a{1,0} or a{0,1}, the unitary only depends on the \
coefficients of the original coarse state.

Erick told me that the Metropolis Hastings -even if it\[CloseCurlyQuote]s \
coded in Mathematica- is a lot faster. So let\[CloseCurlyQuote]s go with that \
instead\
\>", "Text",
 CellChangeTimes->{{3.852059932650199*^9, 3.8520599965646048`*^9}, {
  3.852060410968*^9, 3.8520604143817863`*^9}, {3.8520604802414103`*^9, 
  3.85206049580295*^9}, {3.852060809447435*^9, 3.852061006004059*^9}, {
  3.8521521017595797`*^9, 3.8521521032946367`*^9}, {3.85232384164272*^9, 
  3.852323890996172*^9}},ExpressionUUID->"dbf2b497-066c-435e-b30d-\
7a789a0afc87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Probability", " ", "distribution", " ", "which", " ", "we", " ", "want", 
    " ", "samples", " ", 
    RowBox[{"from", ".", " ", "It"}], " ", 
    RowBox[{"doesn", "'"}], "t", " ", "need", " ", "to", " ", "be", " ", 
    "normalized"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"testDistribution", "[", 
     RowBox[{"beta_", ",", "targetstate_", ",", "state_", ",", "swapP_"}], 
     "]"}], ":=", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "beta"}], "*", 
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"targetstate", " ", "-", " ", 
         RowBox[{"coarseGraining2", "[", 
          RowBox[{"state", ",", "swapP"}], "]"}]}], ",", 
        "\"\<Frobenius\>\""}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"metropolisHastingsSample", "[", 
     RowBox[{
     "size_", ",", "\[Beta]_", ",", "\[Delta]_", ",", "swapP_", ",", 
      "initialstate_", ",", "targetstate_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", "0"}], ",", " ", 
        RowBox[{"X", " ", "=", " ", "initialstate"}], ",", " ", "Y", ",", " ",
         "U", ",", " ", "\[Alpha]", ",", " ", 
        RowBox[{"statelist", " ", "=", " ", 
         RowBox[{"{", "}"}]}]}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"n", " ", "<", " ", "size"}], ",", 
         RowBox[{"1", "/", 
          RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "I"}], "*", 
            RowBox[{"1", "/", 
             RowBox[{"Sqrt", "[", "2", "]"}]}], "\n", "\t\t", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Y", " ", "=", " ", 
               RowBox[{
                RowBox[{"ketsToDensity", "[", 
                 RowBox[{"randomKets", "[", 
                  RowBox[{"4", ",", "1"}], "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "*)"}], "\n", "\t\t",
             "U"}], " ", "=", " ", 
           RowBox[{"randomSmallEvolution", "[", 
            RowBox[{"4", ",", "\[Delta]"}], "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"Y", " ", "=", " ", 
           RowBox[{"U", ".", "X", ".", 
            RowBox[{"ConjugateTranspose", "[", "U", "]"}]}]}], ";", "\n", 
          "\t\t", 
          RowBox[{"\[Alpha]", " ", "=", " ", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"testDistribution", "[", 
               RowBox[{
               "\[Beta]", ",", "targetstate", ",", "Y", ",", "swapP"}], "]"}],
               "/", 
              RowBox[{"testDistribution", "[", 
               RowBox[{
               "\[Beta]", ",", "targetstate", ",", "X", ",", "swapP"}], 
               "]"}]}], ",", "1"}], "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"X", " ", "=", " ", 
           RowBox[{"RandomChoice", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Alpha]", ",", " ", 
               RowBox[{"1", " ", "-", " ", "\[Alpha]"}]}], "}"}], "->", 
             RowBox[{"{", 
              RowBox[{"Y", ",", "X"}], "}"}]}], "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"X", " ", "==", " ", "Y"}], ",", " ", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"statelist", ",", "X"}], "]"}], ";", 
             RowBox[{"n", "++"}]}]}], "]"}]}]}], "\n", "\t", "]"}], ";", "\n",
        "\t", 
       RowBox[{"Return", "[", "statelist", "]"}]}]}], "\n", "\t", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cgfidelitylist", "[", 
     RowBox[{"bigstateslist_", ",", "targetstate_", ",", "swapP_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"fidelity", "[", 
       RowBox[{
        RowBox[{"coarseGraining2", "[", 
         RowBox[{"#", ",", "swapP"}], "]"}], ",", "targetstate"}], "]"}], 
      "&"}], "/@", "bigstateslist"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cgfrobeniuslist", "[", 
     RowBox[{"bigstateslist_", ",", "targetstate_", ",", "swapP_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"coarseGraining2", "[", 
          RowBox[{"#", ",", "swapP"}], "]"}], "-", "targetstate"}], ",", 
        "\"\<Frobenius\>\""}], "]"}], "&"}], "/@", 
     "bigstateslist"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.852324097283902*^9, 3.8523240978841133`*^9}, {
   3.852324183779661*^9, 3.8523241841325207`*^9}, {3.852324256458295*^9, 
   3.852324257051331*^9}, {3.85232432508547*^9, 3.852324328672029*^9}, {
   3.852324520176124*^9, 3.8523245212729807`*^9}, {3.85232612014769*^9, 
   3.852326121015481*^9}, 
   3.852676772951886*^9},ExpressionUUID->"88e14e93-d3d1-404f-bf55-\
d184dc697e7b"],

Cell["\<\
So, using the results from the MH notebook, it seems that delta should be \
around 0.8. Also, \[Beta]=200 works great for a 0.01 tolerance. Let\
\[CloseCurlyQuote]s do some tests shall we.\
\>", "Text",
 CellChangeTimes->{{3.852324188471055*^9, 
  3.852324244655163*^9}},ExpressionUUID->"e34585f9-2779-4eb1-80c5-\
fb29d282e79e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "generates", " ", "states", " ", "and", " ", "distance", " ",
      "data"}], ",", 
    RowBox[{"given", " ", "beta"}], ",", "delta", ",", "n"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"n", "=", "1000"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"beta", "=", "100"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"delta", "=", "0.6"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"swapP", "=", "0.3"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"zcoord", "=", "0.8"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"targetstate", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "2", "]"}], "+", 
        RowBox[{"zcoord", "*", 
         RowBox[{"PauliMatrix", "[", "3", "]"}]}]}], ")"}], "/", "2"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"metropolisHastingsSample", "[", 
      RowBox[{"n", ",", "beta", ",", "delta", ",", "swapP", ",", 
       RowBox[{
        RowBox[{"ketsToDensity", "[", 
         RowBox[{"randomKets", "[", 
          RowBox[{"4", ",", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "targetstate"}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"thertestdist", "=", 
     RowBox[{"cgfrobeniuslist", "[", 
      RowBox[{"data", ",", "targetstate", ",", "swapP"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Mean distance between images and target: \>\"", ",", " ", 
     RowBox[{"Mean", "[", "thertestdist", "]"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Total generated states: \>\"", ",", 
     RowBox[{"Length", "[", "data", "]"}]}], "]"}], "\n", 
   RowBox[{
    RowBox[{"filename", "=", 
     RowBox[{"\"\<MHstates_n=\>\"", "<>", 
      RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<_z=\>\"", "<>", 
      RowBox[{"ToString", "[", "zcoord", "]"}], "<>", "\"\<_p=\>\"", "<>", 
      RowBox[{"ToString", "[", "swapP", "]"}], "<>", "\"\<_beta=\>\"", "<>", 
      RowBox[{"ToString", "[", "beta", "]"}], "<>", "\"\<_delta=\>\"", "<>", 
      RowBox[{"ToString", "[", "delta", "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filename", "<>", "\"\<_data\>\"", "<>", "\"\<.m\>\""}], ",", 
      "data"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Calculation", " ", "of", " ", "the", " ", "average", " ", "state"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"averageState", "=", 
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{"Plus", ",", "data"}], "]"}], "/", 
      RowBox[{"Length", "[", "data", "]"}]}]}], ";"}], "\n", 
   RowBox[{"fidelity", "[", 
    RowBox[{"targetstate", ",", 
     RowBox[{"coarseGraining2", "[", 
      RowBox[{"averageState", ",", "swapP"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.852324333881871*^9, 3.852324339730126*^9}, 
   3.852324377355442*^9, {3.852324411984023*^9, 3.852324480094963*^9}, {
   3.852324545777472*^9, 3.8523245459559593`*^9}, {3.8523253832824707`*^9, 
   3.852325389769581*^9}, 3.852325441340126*^9, {3.8523255688063297`*^9, 
   3.85232557290027*^9}, {3.8523256189880743`*^9, 3.852325664851675*^9}, {
   3.8523260158225822`*^9, 3.852326034989936*^9}, {3.852326172525505*^9, 
   3.852326197779702*^9}, {3.85232661093508*^9, 3.852326636156684*^9}, {
   3.852327313804558*^9, 3.852327313861883*^9}, {3.852329081018323*^9, 
   3.852329086698847*^9}, {3.852329152261585*^9, 3.852329154928103*^9}, {
   3.85232954810445*^9, 
   3.852329548691786*^9}},ExpressionUUID->"ade7c0e9-819a-4673-a3a6-\
227e4a246ddb"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Mean distance between images and target: \"\>", 
   "\[InvisibleSpace]", "0.05578025153893538`"}],
  SequenceForm[
  "Mean distance between images and target: ", 0.05578025153893538],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.852324571022437*^9, 3.8523254645837307`*^9, 3.852325546827477*^9, 
   3.852325929494977*^9, {3.8523260213901463`*^9, 3.8523260261422253`*^9}, 
   3.852326091010809*^9, 3.8523262311591387`*^9, 3.8523269106319513`*^9, 
   3.8523290711947308`*^9, 3.8523291356955767`*^9, 3.85232939318368*^9},
 CellLabel->
  "During evaluation of \
In[26]:=",ExpressionUUID->"295ba284-6dc3-43d8-bdae-7bb0c985a926"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total generated states: \"\>", "\[InvisibleSpace]", "1000"}],
  SequenceForm["Total generated states: ", 1000],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.852324571022437*^9, 3.8523254645837307`*^9, 3.852325546827477*^9, 
   3.852325929494977*^9, {3.8523260213901463`*^9, 3.8523260261422253`*^9}, 
   3.852326091010809*^9, 3.8523262311591387`*^9, 3.8523269106319513`*^9, 
   3.8523290711947308`*^9, 3.8523291356955767`*^9, 3.8523293931858664`*^9},
 CellLabel->
  "During evaluation of \
In[26]:=",ExpressionUUID->"910da3a8-9671-4e9b-b44c-dcaaab56f704"]
}, Open  ]],

Cell[BoxData["0.9998459490915922`"], "Output",
 CellChangeTimes->{
  3.852325929513139*^9, {3.8523260213876877`*^9, 3.852326026171747*^9}, 
   3.8523260910483932`*^9, 3.852326231200836*^9, 3.852326910672286*^9, 
   3.852329071162175*^9, 3.852329135721531*^9, 3.852329393187883*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"5eadb04d-c697-4da7-a2c1-4d5efadf6a30"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"filename", "<>", "\"\<_data\>\"", "<>", "\"\<.m\>\""}], ",", 
    "data"}], "]"}], ";"}]], "Input",
 CellLabel->"In[40]:=",ExpressionUUID->"a1651ad4-b76b-4737-8e3d-ab57435d3ff5"],

Cell["\<\
Now that that\[CloseCurlyQuote]s finised, let\[CloseCurlyQuote]s make some \
functions that will let us use those states for a bunch of different states.\
\>", "Text",
 CellChangeTimes->{{3.852329572083128*^9, 
  3.8523296069023438`*^9}},ExpressionUUID->"73dd40d7-979f-4d2f-8a79-\
59f0e064d2ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UB2Q", "[", 
   RowBox[{"qubit2_", ",", "qubit1_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u1", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"qubit1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"Conjugate", "[", 
             RowBox[{"qubit1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"qubit1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"qubit1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"u2", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"qubit2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"qubit2", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"qubit2", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"qubit2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "}"}]}]}], "}"}], ",", 
    
    RowBox[{"u1", ".", "u2"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.852329619306183*^9, 3.852329902711344*^9}, {
  3.852676649419713*^9, 3.85267665184305*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"7eb803fd-31cc-4533-bcf5-2ab49bceb222"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"UB2Q", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.852329913040275*^9, 3.852329924775127*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"42839155-d94c-4ab8-b9eb-61d44a62468f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.852329925539462*^9, 3.852676659624421*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"1a872f20-0f58-435f-82fd-0ee8a82a6a6a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"UB2Q", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "I"}], "*", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}]}]}], "}"}]}], "]"}], ".", 
  RowBox[{"{", 
   RowBox[{"1", ",", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8523299292910624`*^9, 3.852330030508638*^9}, {
  3.8526766741725063`*^9, 3.852676679440558*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"370a8fe6-fa7a-4cf6-85e7-6aa9823952e8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", 
    SqrtBox["2"]], ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8523299407410097`*^9, {3.8523300172082663`*^9, 3.85233003142406*^9}, {
   3.852676662267799*^9, 3.852676680296793*^9}},
 CellLabel->"Out[24]=",ExpressionUUID->"23208b0e-df4d-486d-a583-513830bc3b2c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "1000"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"beta", "=", "100"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"delta", "=", "0.6"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"swapP", "=", "0.3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zcoord", "=", "0.8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"\"\<MHstates_n=\>\"", "<>", 
    RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<_z=\>\"", "<>", 
    RowBox[{"ToString", "[", "zcoord", "]"}], "<>", "\"\<_p=\>\"", "<>", 
    RowBox[{"ToString", "[", "swapP", "]"}], "<>", "\"\<_beta=\>\"", "<>", 
    RowBox[{"ToString", "[", "beta", "]"}], "<>", "\"\<_delta=\>\"", "<>", 
    RowBox[{"ToString", "[", "delta", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Get", "[", 
    RowBox[{"filename", "<>", "\"\<_data\>\"", "<>", "\"\<.m\>\""}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.852330140467608*^9, 3.852330158049816*^9}, 
   3.852330238490749*^9, 3.852330352149528*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"a97af28a-db13-4c23-ba7b-c827faa024b4"],

Cell["\<\
I\[CloseCurlyQuote]m thinking that in might not even been necessary to apply \
the unitary to all states. After all, all operations we are doing are linear. \
We can just apply the unitary to the assignment map! How wonderful! \
\>", "Text",
 CellChangeTimes->{{3.852329766161817*^9, 3.8523297684386663`*^9}, {
  3.852330888865966*^9, 3.852330944531007*^9}, {3.8523708139374247`*^9, 
  3.852370814753069*^9}},ExpressionUUID->"d26e91ac-c3fa-4d02-81f7-\
aafaeb8b5788"],

Cell["So I just did the math and I\[CloseCurlyQuote]m in the right path. ", \
"Text",
 CellChangeTimes->{{3.852370818261392*^9, 3.85237083389746*^9}, {
  3.852371409468346*^9, 
  3.8523714156498632`*^9}},ExpressionUUID->"7460f4f1-80bd-4f9f-a27d-\
d0f98886f967"],

Cell[BoxData[{
 RowBox[{"preassignement", "=", 
  RowBox[{"Total", "[", 
   RowBox[{"data", "/", 
    RowBox[{"Length", "[", "data", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"newstatebv", "=", 
  RowBox[{"Rest", "[", 
   RowBox[{"ToSphericalCoordinates", "[", 
    RowBox[{
     RowBox[{"densityMatrixToPoint", "[", 
      RowBox[{"{", "newstate", "}"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newket", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "#1", "]"}], ",", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"I", "*", "#2"}], "]"}], "*", 
        RowBox[{"Sin", "[", "#1", "]"}]}]}], "}"}], "&"}], "[", "newstatebv", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"assignement", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"U", "=", 
      RowBox[{"UB2Q", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], ",", "newket"}], "]"}]}], "}"}], ",", 
    RowBox[{"U", ".", "preassignement", ".", 
     RowBox[{"Dagger", "[", "U", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newstates", "[", 
   RowBox[{"coarsestate_", ",", "finestate"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"U", "=", 
     RowBox[{"UB2Q", "[", 
      RowBox[{"#1", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"U", ",", "U"}], "]"}], ".", "#"}], ")"}], "&"}], ",", 
      "#2"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{",", "purestates"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"purebv", "=", 
   RowBox[{"densityMatrixToPoint", "[", 
    RowBox[{
     RowBox[{"ketsToDensity", "[", "purestates", "]"}], ",", 
     RowBox[{"gellMannBasis", "[", "1", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mixedbv", "=", 
   RowBox[{"0.8", "*", "purebv"}]}], 
  ";"}], "\[IndentingNewLine]", "mixedstates"}], "Input",
 CellChangeTimes->{{3.8523714612490883`*^9, 3.8523714695308228`*^9}, {
  3.852372104367065*^9, 3.852372115617174*^9}, {3.8523721460998993`*^9, 
  3.8523721503783817`*^9}, {3.852372516214169*^9, 3.852372525172943*^9}, {
  3.852676195485865*^9, 3.852676247319113*^9}, {3.852676401144971*^9, 
  3.852676411594289*^9}, {3.852676501664422*^9, 3.8526766154177437`*^9}, {
  3.852676693739293*^9, 3.852676760588716*^9}, {3.852676817780478*^9, 
  3.8526768208204327`*^9}},ExpressionUUID->"70815bd9-fa05-42f1-8795-\
05e7e030e198"]
}, Closed]],

Cell["Now the solution", "Section",
 CellChangeTimes->{{3.8526769286849737`*^9, 
  3.852676932856715*^9}},ExpressionUUID->"61d4018b-a708-4469-8dee-\
4b16bbcce02c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tarea -", "Chapter",
 CellChangeTimes->{{3.852323764318741*^9, 
  3.8523237717800627`*^9}},ExpressionUUID->"ccf0918f-abbb-46ba-98a0-\
3822f50e45b9"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.852331116536281*^9, 
  3.852331133603036*^9}},ExpressionUUID->"a70b9181-e273-40c1-877a-\
4739a89dfa33"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 704},
WindowMargins->{{0, Automatic}, {0, Automatic}},
Magnification:>1.2 Inherited,
FrontEndVersion->"12.3 for Linux x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Dracula.nb",
ExpressionUUID->"dabed11f-0f4a-4769-b3cc-3bf02e1048eb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 147, 2, 117, "Title",ExpressionUUID->"2dc5b104-8e2d-4468-bcf4-8210550113b1"],
Cell[CellGroupData[{
Cell[752, 28, 166, 3, 81, "Chapter",ExpressionUUID->"20cc9388-4870-4d51-aae4-f3782afccc7e"],
Cell[921, 33, 1407, 31, 284, "Input",ExpressionUUID->"b7248f51-c213-4fe4-8d0e-cc4469fb660e",
 InitializationCell->True],
Cell[2331, 66, 1795, 45, 159, "Input",ExpressionUUID->"76c48127-75ee-4739-838f-0178c17b6bb4",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[4163, 116, 163, 3, 81, "Chapter",ExpressionUUID->"501dca48-d6de-4637-bec3-02854ac8d422"],
Cell[CellGroupData[{
Cell[4351, 123, 150, 3, 64, "Subsection",ExpressionUUID->"3c7ef3b2-de0e-4d03-9636-62eda8c7e373"],
Cell[CellGroupData[{
Cell[4526, 130, 694, 17, 84, "Input",ExpressionUUID->"6ee24912-cb1d-4394-8854-d6152aaa80a0"],
Cell[5223, 149, 408, 10, 33, "Message",ExpressionUUID->"157ae39b-a218-4b5a-aeda-d68089a415ce"]
}, Open  ]],
Cell[5646, 162, 310, 6, 35, "Input",ExpressionUUID->"ddb3e758-a2d5-423d-b7a1-20524a8aa90f"],
Cell[5959, 170, 429, 10, 35, "Input",ExpressionUUID->"2bd032b2-043c-42cb-85c3-c70feb809abd"],
Cell[6391, 182, 171, 3, 42, "Text",ExpressionUUID->"d06fade2-1ff1-4a1a-92a0-d44bd0323cf7"],
Cell[CellGroupData[{
Cell[6587, 189, 434, 8, 60, "Input",ExpressionUUID->"0e7e0517-fcee-4e84-bd9a-f3eb7ad91d14"],
Cell[7024, 199, 2741, 60, 117, "Output",ExpressionUUID->"3ca054bf-e4a4-4c6f-a573-70655af8013f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9802, 264, 289, 6, 60, "Input",ExpressionUUID->"2acc475c-be61-44c0-b89e-e9776d23736e"],
Cell[10094, 272, 1099, 27, 72, "Output",ExpressionUUID->"f39ef42b-05c4-48b3-9359-679c67d1ae6f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11230, 304, 457, 11, 60, "Input",ExpressionUUID->"02d0096e-246a-40a9-a39d-f8a3a5f6dfe5"],
Cell[11690, 317, 2689, 59, 117, "Output",ExpressionUUID->"aba115ba-d364-4fac-b83d-282e9637e69e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14416, 381, 355, 7, 60, "Input",ExpressionUUID->"d0e96900-c560-4e11-bd97-6c99d4914556"],
Cell[14774, 390, 1148, 30, 72, "Output",ExpressionUUID->"35e9e700-722a-4105-b1f8-ccc76448324f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15959, 425, 341, 7, 35, "Input",ExpressionUUID->"7718ce39-e976-42b1-99d6-59fe95016e37"],
Cell[16303, 434, 474, 12, 39, "Output",ExpressionUUID->"b29d20bb-8cb5-4996-a76d-4f7539e90fdc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16814, 451, 198, 3, 35, "Input",ExpressionUUID->"bf5261f2-5f7f-4dc0-b574-00711640ec44"],
Cell[17015, 456, 234, 5, 39, "Output",ExpressionUUID->"1ad95e82-09e3-4d35-a82e-481515af7bc4"]
}, Open  ]],
Cell[17264, 464, 278, 6, 42, "Text",ExpressionUUID->"57294b82-1047-4d61-b5d7-f47f57664993"],
Cell[CellGroupData[{
Cell[17567, 474, 259, 5, 35, "Input",ExpressionUUID->"e028805f-552b-47ac-a355-3838dfe88545"],
Cell[17829, 481, 398, 8, 39, "Output",ExpressionUUID->"af20efff-0c8d-4b8a-8bba-4a87c40629d3"]
}, Open  ]],
Cell[18242, 492, 189, 3, 42, "Text",ExpressionUUID->"68d2991b-fb3a-41da-abf4-a8e8696fadaf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18468, 500, 154, 3, 64, "Subsection",ExpressionUUID->"6811d892-d61b-4224-ba37-5efbb615aee0"],
Cell[18625, 505, 952, 26, 109, "Input",ExpressionUUID->"d92a96c8-c1de-428b-a95b-3e274f5ae8f8"],
Cell[19580, 533, 309, 6, 35, "Input",ExpressionUUID->"e0e06cba-7ea5-481e-9910-20fa7ae75bcd"],
Cell[19892, 541, 471, 11, 35, "Input",ExpressionUUID->"3135e394-d186-4462-907b-555fee0dec51"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[20412, 558, 167, 3, 67, "Chapter",ExpressionUUID->"cbcce0b4-1171-4747-9da3-e21114656bb0"],
Cell[20582, 563, 184, 3, 41, "Text",ExpressionUUID->"e056893b-f16e-4be1-bf6a-dd4ae65a9f0f"],
Cell[20769, 568, 2532, 67, 234, "Input",ExpressionUUID->"a5e4566a-7e71-43c6-963f-96f7de53223e"],
Cell[CellGroupData[{
Cell[23326, 639, 242, 4, 58, "Input",ExpressionUUID->"2692ff5c-2dda-480c-8a91-13b8152677f9"],
Cell[23571, 645, 2543, 77, 67, "Output",ExpressionUUID->"20001aab-03d4-4901-aa80-e45dfae92bcc"]
}, Open  ]],
Cell[26129, 725, 205, 3, 41, "Text",ExpressionUUID->"95e221f0-fdef-42c8-86e1-f75f730d9ab2"],
Cell[CellGroupData[{
Cell[26359, 732, 960, 26, 184, "Input",ExpressionUUID->"889528e2-f48d-494c-abd6-d4e06b7fdcdb"],
Cell[27322, 760, 178, 2, 40, "Output",ExpressionUUID->"b08163f0-0d7c-460f-8f92-519491de2c96"]
}, Open  ]],
Cell[27515, 765, 355, 7, 41, "Text",ExpressionUUID->"cb22fa1e-4c8a-49a7-8561-944371c8484c"],
Cell[27873, 774, 2633, 62, 284, "Input",ExpressionUUID->"d19c4c51-9522-4c25-a173-fcbf684860f1"],
Cell[30509, 838, 205, 3, 41, "Text",ExpressionUUID->"4a428d77-c504-4910-9b52-9b9679070a7d"],
Cell[30717, 843, 1438, 38, 159, "Input",ExpressionUUID->"11da57ad-ec6f-48b5-856e-ed11eec40ac6"],
Cell[CellGroupData[{
Cell[32180, 885, 209, 3, 58, "Input",ExpressionUUID->"5bb28f06-766e-48c1-b045-0b48e5c98978"],
Cell[32392, 890, 1135, 28, 73, "Output",ExpressionUUID->"d06b18dd-f777-4e8f-aba9-7bb901d80a1c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33564, 923, 212, 3, 58, "Input",ExpressionUUID->"f9b640a8-7342-43fe-9222-f10430d4678a"],
Cell[33779, 928, 1148, 27, 81, "Output",ExpressionUUID->"7260649e-946f-4c87-96a8-851fc4d8b5fb"]
}, Open  ]],
Cell[34942, 958, 605, 12, 109, "Input",ExpressionUUID->"e548d8b7-016a-46af-831a-e8e0bc77bd26"],
Cell[CellGroupData[{
Cell[35572, 974, 242, 4, 58, "Input",ExpressionUUID->"5fd91e88-8106-47f8-9835-2825844aba6d"],
Cell[35817, 980, 709, 11, 91, "Output",ExpressionUUID->"b017267f-74d3-4656-ac4c-7040f43206de"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36575, 997, 192, 3, 81, "Chapter",ExpressionUUID->"fd175aa6-bbe4-4667-8266-b9fd1bf55275"],
Cell[CellGroupData[{
Cell[36792, 1004, 2562, 72, 157, "Input",ExpressionUUID->"cc307c1d-64bc-48e0-9870-3ec1d6e19ccc"],
Cell[39357, 1078, 1656, 48, 108, "Output",ExpressionUUID->"691e4910-5b2e-4a97-b318-84d31f6d9d9e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41050, 1131, 208, 3, 35, "Input",ExpressionUUID->"ff57c742-20b4-40a6-b43c-3eef534a4f3c"],
Cell[41261, 1136, 4046, 120, 157, "Output",ExpressionUUID->"328c6ef6-9dc3-45ae-bcff-e24e25db2b00"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45344, 1261, 455, 10, 35, "Input",ExpressionUUID->"750ebe38-5761-4d1b-b7f5-0d8ffa5e67dd"],
Cell[45802, 1273, 360, 7, 39, "Output",ExpressionUUID->"709e60dd-5b1f-46f7-8728-8367de48f8f0"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[46211, 1286, 178, 3, 67, "Chapter",ExpressionUUID->"ba5c06e5-7aed-4143-b877-787c303587c2"],
Cell[46392, 1291, 642, 16, 84, "Input",ExpressionUUID->"9bb3dcf2-d4c2-4ca7-af57-4fe42e903d4a"],
Cell[CellGroupData[{
Cell[47059, 1311, 2259, 55, 157, "Input",ExpressionUUID->"64cab554-074c-4ac0-8766-4071fb6c9280"],
Cell[49321, 1368, 243, 5, 39, "Output",ExpressionUUID->"d81dc8f3-9cad-4294-b70e-74de65b32de5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49601, 1378, 173, 2, 35, "Input",ExpressionUUID->"6bd000d7-174e-4d1d-9edf-b2f947823afe"],
Cell[49777, 1382, 1000, 32, 42, "Output",ExpressionUUID->"2e653954-dba5-49f8-ba40-7ee7d8707e59"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50814, 1419, 310, 5, 35, "Input",ExpressionUUID->"b58bc46d-f297-4fb3-bf04-f942d7ef71c5"],
Cell[51127, 1426, 1325, 42, 70, "Output",ExpressionUUID->"3182e048-7610-410c-9525-3978eb9f145d"]
}, Open  ]],
Cell[52467, 1471, 284, 7, 42, "Text",ExpressionUUID->"baf7684b-4781-4780-924b-7ad83cc32911"],
Cell[52754, 1480, 830, 23, 60, "Input",ExpressionUUID->"9208784e-eee2-4674-b514-3a8ccfdffcc2"],
Cell[CellGroupData[{
Cell[53609, 1507, 204, 3, 35, "Input",ExpressionUUID->"c9a1bb4f-2800-4b84-a647-8fc583a3a9a3"],
Cell[53816, 1512, 3484, 109, 87, "Output",ExpressionUUID->"ee88b77b-907b-4be7-83c2-2d58246ac2ec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57337, 1626, 551, 14, 35, "Input",ExpressionUUID->"aada69b4-d270-463e-a8c5-77d7eb0ce96f"],
Cell[57891, 1642, 927, 28, 74, "Output",ExpressionUUID->"93008ce9-5f1b-43a8-8310-fcf2f1c14d27"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58855, 1675, 649, 17, 60, "Input",ExpressionUUID->"a3648826-7307-406c-a1aa-3f7633909970"],
Cell[59507, 1694, 756, 23, 74, "Output",ExpressionUUID->"9f2a4bcd-23b1-4d23-ad7c-54259e654691"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60300, 1722, 205, 3, 35, "Input",ExpressionUUID->"123bacb0-9fcd-48a1-94a7-76dc8ac469a3"],
Cell[60508, 1727, 1246, 41, 127, "Output",ExpressionUUID->"b58283a0-2b8c-4cee-83aa-b53988940b3f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61791, 1773, 372, 8, 35, "Input",ExpressionUUID->"1e8782e9-2b4e-49e1-a0ce-c44be26d9b57"],
Cell[62166, 1783, 866, 31, 213, "Output",ExpressionUUID->"74bbedbc-6842-458a-8dd6-aacc1761fb12"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63069, 1819, 205, 3, 35, "Input",ExpressionUUID->"360696f0-dfc1-408c-840b-d673cd95bad6"],
Cell[63277, 1824, 316, 8, 39, "Output",ExpressionUUID->"c05cb8b5-915c-4bef-97c7-3a3d4015193c"]
}, Open  ]],
Cell[63608, 1835, 156, 3, 35, "Input",ExpressionUUID->"2b2fd963-ffe1-48df-af06-7ce06823a1a1"]
}, Closed]],
Cell[CellGroupData[{
Cell[63801, 1843, 182, 3, 67, "Chapter",ExpressionUUID->"68a388df-bdb2-4f72-9b0a-481de7fbd23e"],
Cell[CellGroupData[{
Cell[64008, 1850, 157, 3, 81, "Section",ExpressionUUID->"8d116cde-2272-4fdb-b99b-b80449b38f1a"],
Cell[64168, 1855, 1086, 28, 134, "Input",ExpressionUUID->"e9f3d30b-0527-4f91-88bc-953eae920a21"],
Cell[65257, 1885, 438, 8, 68, "Text",ExpressionUUID->"e471d57b-1a39-4d84-8612-cab420828c16"],
Cell[65698, 1895, 2426, 45, 336, "Code",ExpressionUUID->"69a7b947-7b97-4fda-a47f-f04511bbf0c3",
 InitializationCell->False],
Cell[CellGroupData[{
Cell[68149, 1944, 173, 2, 58, "Input",ExpressionUUID->"d50572f9-be7a-4bab-8e65-b2e5a915cec6"],
Cell[68325, 1948, 205, 4, 40, "Output",ExpressionUUID->"55a4d5fe-8841-465c-9ed2-4b60c62cd75a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68567, 1957, 209, 3, 58, "Input",ExpressionUUID->"59257c2e-bebb-4ac6-af2a-2920de9b5402"],
Cell[68779, 1962, 198, 4, 40, "Output",ExpressionUUID->"1d97b8cf-2d8a-4c40-af1a-cc23a47e48ec"]
}, Open  ]],
Cell[68992, 1969, 1137, 19, 174, "Text",ExpressionUUID->"dbf2b497-066c-435e-b30d-7a789a0afc87"],
Cell[70132, 1990, 5009, 124, 534, "Input",ExpressionUUID->"88e14e93-d3d1-404f-bf55-d184dc697e7b",
 InitializationCell->True],
Cell[75144, 2116, 338, 7, 41, "Text",ExpressionUUID->"e34585f9-2779-4eb1-80c5-fb29d282e79e"],
Cell[CellGroupData[{
Cell[75507, 2127, 3711, 89, 459, "Input",ExpressionUUID->"ade7c0e9-819a-4673-a3a6-227e4a246ddb"],
Cell[CellGroupData[{
Cell[79243, 2220, 681, 14, 28, "Print",ExpressionUUID->"295ba284-6dc3-43d8-bdae-7bb0c985a926"],
Cell[79927, 2236, 612, 12, 28, "Print",ExpressionUUID->"910da3a8-9671-4e9b-b44c-dcaaab56f704"]
}, Open  ]],
Cell[80554, 2251, 360, 5, 40, "Output",ExpressionUUID->"5eadb04d-c697-4da7-a2c1-4d5efadf6a30"]
}, Open  ]],
Cell[80929, 2259, 253, 6, 58, "Input",ExpressionUUID->"a1651ad4-b76b-4737-8e3d-ab57435d3ff5"],
Cell[81185, 2267, 305, 6, 41, "Text",ExpressionUUID->"73dd40d7-979f-4d2f-8a79-59f0e064d2ce"],
Cell[81493, 2275, 1736, 49, 109, "Input",ExpressionUUID->"7eb803fd-31cc-4533-bcf5-2ab49bceb222",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[83254, 2328, 323, 8, 58, "Input",ExpressionUUID->"42839155-d94c-4ab8-b9eb-61d44a62468f"],
Cell[83580, 2338, 335, 9, 40, "Output",ExpressionUUID->"1a872f20-0f58-435f-82fd-0ee8a82a6a6a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83952, 2352, 629, 18, 58, "Input",ExpressionUUID->"370a8fe6-fa7a-4cf6-85e7-6aa9823952e8"],
Cell[84584, 2372, 401, 11, 61, "Output",ExpressionUUID->"23208b0e-df4d-486d-a583-513830bc3b2c"]
}, Open  ]],
Cell[85000, 2386, 1117, 26, 234, "Input",ExpressionUUID->"a97af28a-db13-4c23-ba7b-c827faa024b4"],
Cell[86120, 2414, 476, 8, 68, "Text",ExpressionUUID->"d26e91ac-c3fa-4d02-81f7-aafaeb8b5788"],
Cell[86599, 2424, 261, 5, 41, "Text",ExpressionUUID->"7460f4f1-80bd-4f9f-a27d-d0f98886f967"],
Cell[86863, 2431, 2743, 73, 284, "Input",ExpressionUUID->"70815bd9-fa05-42f1-8795-05e7e030e198"]
}, Closed]],
Cell[89621, 2507, 163, 3, 63, "Section",ExpressionUUID->"61d4018b-a708-4469-8dee-4b16bbcce02c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89821, 2515, 154, 3, 81, "Chapter",ExpressionUUID->"ccf0918f-abbb-46ba-98a0-3822f50e45b9"],
Cell[89978, 2520, 152, 3, 58, "Input",ExpressionUUID->"a70b9181-e273-40c1-877a-4739a89dfa33"]
}, Open  ]]
}, Open  ]]
}
]
*)

